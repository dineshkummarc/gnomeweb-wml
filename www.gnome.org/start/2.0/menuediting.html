<html><head><meta content="text/html; charset=ISO-8859-1" http-equiv="Content-Type"><title>Menu Editing</title><meta name="generator" content="DocBook XSL Stylesheets V1.50.0"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="article"><div class="titlepage"><div><h2 class="title"><a name="id2752659"></a>Menu Editing</h2></div><hr></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><a href="#introduction">Introduction</a></dt><dd><dl><dt><a href="#nostandardlocation">No Standard Location</a></dt><dt><a href="#menustructureproblem">Structure of menu is set by the location on disk</a></dt></dl></dd><dt><a href="#howdoesitwork">How Does It All Work?</a></dt><dd><dl><dt><a href="#categories">Categories</a></dt><dt><a href="#showonlyin">ShowOnlyIn</a></dt></dl></dd><dt><a href="#practicalities">Making It Work</a></dt><dd><dl><dt><a href="#addentries">To Add Menu Entries</a></dt><dt><a href="#removeentries">To Remove Menu Entries</a></dt><dt><a href="#changeorderapps">To change the order of the 'Applications' menu</a></dt><dt><a href="#changeorderprefs">To change the order of the 'Desktop Preferences' menu</a></dt><dt><a href="#remaddsubmenuapps">To remove/add submenus in the 'Applications' menu</a></dt><dt><a href="#createnewsubresearchapp">To create a new submenu 'Research' in the 'Applications' menu</a></dt></dl></dd><dt><a href="#additionalinfo">Additional Information</a></dt></dl></div><div class="sect1"><div class="titlepage"><div><h2 class="title" style="clear: both"><a name="introduction"></a>Introduction</h2></div></div><p>
	Menu editing in the GNOME 2 desktop has undergone a large amount of re-work
	to move to using <a href="http://developer.gnome.org/doc/API/gnome-vfs/" target="_top">gnome-vfs</a>, the file system abstraction library and
	the implementation of a <a href="http://www.freedesktop.org" target="_top">shared
	vfolder spec</a> between GNOME and other
	desktops for the X Window System. 
      </p><p>
	The menus in GNOME are based on a collection of <a href="http://www.freedesktop.org/standards/desktop-entry-spec/desktop-entry-spec.html" target="_top">.desktop files</a>
	arranged in a suitable  order depending on their contents.  For GNOME
	1.4, there were 2 main problems with the  way these .desktop files were
	handled:
      </p><div class="sect2"><div class="titlepage"><div><h3 class="title"><a name="nostandardlocation"></a>No Standard Location</h3></div></div><p>
	  With no standard location, 3rd party application developers do not
	  know where to install their .desktop files for them to be picked up by
	  the menu. Many distributions have their own idea of where this
	  location should be, creating a large amount of unecessary
	  inconsistency and heartache trying to integrate your application on
	  various distributions.
	</p></div><div class="sect2"><div class="titlepage"><div><h3 class="title"><a name="menustructureproblem"></a>Structure of menu is set by the location on disk</h3></div></div><p>
	  With a set location, and consequently a set menu structure, it is not
	  possible to change the layout of the menus without adversely affecting
	  3rd party application developers. This inflexibility has bitten many
	  people in the past.
	</p></div></div><div class="sect1"><div class="titlepage"><div><h2 class="title" style="clear: both"><a name="howdoesitwork"></a>How Does It All Work?</h2></div></div><p>
	The menu system, as mentioned in the previous section, is based on
	gnome-vfs using a  'vfolder' mechanism. Menu vfolders aren't much unlike
	Evolution's mail vfolders in that they filter out the menu items, in
	this case the .desktop files, according to their category.
      </p><p>
	The vfolders are based around <a href="http://cvs.gnome.org/bonsai/cvsblame.cgi?file=gnome-vfs/doc/vfolder-info-spec.dtd&amp;rev=&amp;root=/cvs/gnome" target="_top">.vfolder-info files</a>, which are xml
	based. In this  file you specify how your menu should filter the
	.desktop files in terms of  order, category, whether it should include
	optional .desktop file locations, omit  certain .desktop files and many
	other rules.
      </p><p>
	Each menu is based on a .directory file, which for all intents and
      purposes is another .desktop file.
      </p><p>
	With the introduction of this mechanism, it has been necessary to
	introduce 2 new keys to the .desktop file format -
      </p><div class="sect2"><div class="titlepage"><div><h3 class="title"><a name="categories"></a>Categories</h3></div></div><p>
	  This key describes the application and it's potential position within
							    the menus. It is based on a set of distinct, non free form, <a href="http://www.freedesktop.org/standards/FIXME/vfolder-spec.html" target="_top">keywords</a>.</p><p>
	  For example, an application like GNOME Calculator would have the
	  following in its .desktop - 
	  <pre class="programlisting">
	Categories=Application;Utility;
	  </pre>
	</p></div><div class="sect2"><div class="titlepage"><div><h3 class="title"><a name="showonlyin"></a>ShowOnlyIn</h3></div></div><p>
	  This optional key is used when some applications is desktop specific
	  eg. GNOME Panel Preferences.
	</p></div></div><div class="sect1"><div class="titlepage"><div><h2 class="title" style="clear: both"><a name="practicalities"></a>Making It Work</h2></div></div><p>
	</p><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Warning</h3><p>
	    The following is included only for benefit of system administrators
	    and others who need fine-grained control over menu
	    configurations. It is not supported.
	  </p></div><p>
	The standard default location for .desktop files is
	/usr/share/applications, or if that is not available
	$prefix/share/applications. The best advice is to look at the existing
	examples of the various files and try to copy by example.
      </p><p>
      The standard location for applications.vfolder.info is
      <tt>$prefix/etc/gnome-vfs-2.0/vfolders</tt>. These can also be
      mirrored in <tt>~/.gnome2/vfolders</tt>. If you want global
      menus, edit files in <tt>$prefix</tt>, if you want per user edit
      files in user directory.
    </p><div class="sect2"><div class="titlepage"><div><h3 class="title"><a name="addentries"></a>To Add Menu Entries</h3></div></div><p>
	 Create a desktop file using an existing file as a template. edit this
	 file and add/edit a &quot;Categories=&quot; line at the bottom. 
	</p><p>
	  Restart the panel.
	</p></div><div class="sect2"><div class="titlepage"><div><h3 class="title"><a name="removeentries"></a>To Remove Menu Entries</h3></div></div><p>
	  Edit $prefix/etc/gnome-vfs-2.0/applications.vfolder-info to 
	  include an &lt;Exclude&gt; &lt;/Exclude&gt; entry for the appropriate
	  .desktop file.
	</p><p>
	  Restart the panel.
	</p></div><div class="sect2"><div class="titlepage"><div><h3 class="title"><a name="changeorderapps"></a>To change the order of the 'Applications' menu</h3></div></div><p>
	  Edit $prefix/share/gnome/vfolders/Root.order.
	</p></div><div class="sect2"><div class="titlepage"><div><h3 class="title"><a name="changeorderprefs"></a>To change the order of the 'Desktop Preferences' menu</h3></div></div><p>
	  Edit $prefix/share/gnome/vfolders/Settings.order
	</p></div><div class="sect2"><div class="titlepage"><div><h3 class="title"><a name="remaddsubmenuapps"></a>To remove/add submenus in the 'Applications' menu</h3></div></div><p>
	  Edit $prefix/share/gnome/vfolders/Root.order
	</p><p>
	  Edit $prefix/etc/gnome-vfs-2.0/applications.vfolder-info.
	</p></div><div class="sect2"><div class="titlepage"><div><h3 class="title"><a name="createnewsubresearchapp"></a>To create a new submenu 'Research' in the 'Applications' menu</h3></div></div><p>
	  Edit $prefix/share/gnome/vfolders/Root.order to include 'Research'
	</p><p>
	  Add $prefix/share/gnome/vfolders/Research.directory
	</p><p>
	  Edit $prefix/etc/gnome-vfs-2.0/applications.vfolder-info
	</p></div></div><div class="sect1"><div class="titlepage"><div><h2 class="title" style="clear: both"><a name="additionalinfo"></a>Additional Information</h2></div></div><p>
	Additional details on manual editing of menus can be found <a href="http://www.redtux.demon.co.uk/docs/gnome_menu_edit_doc.20_6.html" target="_top">
									  here</a>.
      </p></div></div></body></html>
