<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head><link href="/default.css" rel="stylesheet" type="text/css" /><link href="/img/logo/foot-16.png" rel="icon" type="image/png" />
<title>GNOME 2.0.2 Release Notes - Menu Editing</title>
<meta content="DocBook XSL Stylesheets V1.48" name="generator" />
</head>
<body><div id="body">
<div class="article">
<div class="toc">
<p><strong>Table of Contents</strong></p>
<dl>
<dt><a href="#introduction">Introduction</a></dt>
<dd>
<dl>
<dt><a href="#nostandardlocation">No Standard Location</a></dt>
<dt><a href="#menustructureproblem">Structure of menu is set by the location on disk</a></dt>
</dl>
</dd>
<dt><a href="#howdoesitwork">How Does It All Work?</a></dt>
<dd>
<dl>
<dt><a href="#categories">Categories</a></dt>
<dt><a href="#showonlyin">ShowOnlyIn</a></dt>
</dl>
</dd>
<dt><a href="#practicalities">Making It Work</a></dt>
<dd>
<dl>
<dt><a href="#addentries">To Add Menu Entries</a></dt>
<dt><a href="#removeentries">To Remove Menu Entries</a></dt>
<dt><a href="#remaddsubmenuapps">To remove/add submenus in the 'Applications' menu</a></dt>
<dt><a href="#createnewsubresearchapp">To create a new submenu 'Research' in the 'Applications' menu</a></dt>
</dl>
</dd>
<dt><a href="#additionalinfo">Additional Information</a></dt>
</dl>
</div>
<div class="sect1">
<div class="titlepage">
<h2 class="title"><a id="introduction" name="introduction"></a>Introduction</h2>
</div>
<p>Menu editing in the GNOME 2 desktop has undergone a large amount of re-work to move to using <a href="http://library.gnome.org/devel/gnome-vfs/stable/" target="_top">gnome-vfs</a>, the file system abstraction library and the implementation of a <a href="http://www.freedesktop.org" target="_top">shared vfolder spec</a> between GNOME and other desktops for the X Window System.</p>
<p>The menus in GNOME are based on a collection of <a href="http://www.freedesktop.org/standards/desktop-entry-spec/desktop-entry-spec.html" target="_top">.desktop files</a> arranged in a suitable order depending on their contents. For GNOME 1.4, there were 2 main problems with the way these .desktop files were handled:</p>
<div class="sect2">
<div class="titlepage">
<h3 class="title"><a id="nostandardlocation" name="nostandardlocation"></a>No Standard Location</h3>
</div>
<p>With no standard location, 3rd party application developers do not know where to install their .desktop files for them to be picked up by the menu. Many distributions have their own idea of where this location should be, creating a large amount of unecessary inconsistency and heartache trying to integrate your application on various distributions.</p>
</div>
<div class="sect2">
<div class="titlepage">
<h3 class="title"><a id="menustructureproblem" name="menustructureproblem"></a>Structure of menu is set by the location on disk</h3>
</div>
<p>With a set location, and consequently a set menu structure, it is not possible to change the layout of the menus without adversely affecting 3rd party application developers. This inflexibility has bitten many people in the past.</p>
</div>
</div>
<div class="sect1">
<div class="titlepage">
<h2 class="title"><a id="howdoesitwork" name="howdoesitwork"></a>How Does It All Work?</h2>
</div>
<p>The menu system, as mentioned in the previous section, is based on gnome-vfs using a 'vfolder' mechanism. Menu vfolders aren't much unlike Evolution's mail vfolders in that they filter out the menu items, in this case the .desktop files, according to their category.</p>
<p>The vfolders are based around <a href="http://cvs.gnome.org/bonsai/cvsblame.cgi?file=gnome-vfs/doc/vfolder-info-spec.dtd&amp;rev=&amp;root=/cvs/gnome" target="_top">.vfolder-info files</a>, which are xml based. In this file you specify how your menu should filter the .desktop files in terms of order, category, whether it should include optional .desktop file locations, omit certain .desktop files and many other rules.</p>
<p>Each menu is based on a .directory file, which for all intents and purposes is another .desktop file.</p>
<p>The order of items, both menu items and menu categories, is determined alphabetically based on the name field in the .desktop or .directory file as appropriate.</p>
<p>With the introduction of this mechanism, it has been necessary to introduce 2 new keys to the .desktop file format -</p>
<div class="sect2">
<div class="titlepage">
<h3 class="title"><a id="categories" name="categories"></a>Categories</h3>
</div>
<p>This key describes the application and it's potential position within the menus. It is based on a set of distinct, non free form, <a href="http://www.freedesktop.org/standards/FIXME/vfolder-spec.html" target="_top">keywords</a>.</p>
<p>For example, an application like GNOME Calculator would have the following in its .desktop -</p>
<pre class="programlisting">
        Categories=Application;Utility;
          
</pre></div>
<br />
<div class="sect2">
<div class="titlepage">
<h3 class="title"><a id="showonlyin" name="showonlyin"></a>ShowOnlyIn</h3>
</div>
<p>This optional key is used when some applications is desktop specific eg. GNOME Panel Preferences.</p>
</div>
</div>
<div class="sect1">
<div class="titlepage">
<h2 class="title"><a id="practicalities" name="practicalities"></a>Making It Work</h2>
</div>
<div class="warning">
<h3 class="title">Warning</h3>
<p>The following is included only for benefit of system administrators and others who need fine-grained control over menu configurations. It is not supported.</p>
</div>
The standard default location for .desktop files is <tt>/usr/share/applications</tt>, or if that is not available <tt>$prefix/share/applications</tt>. The best advice is to look at the existing examples of the various files and try to copy by example.<br />
<br />
<p>The standard location for applications.vfolder.info and .directory files is <tt>$prefix/etc/gnome-vfs-2.0/vfolders</tt>. These can also be mirrored in <tt>~/.gnome2/vfolders</tt> (.desktop files in subdir applications). If you want global menus, edit files in <tt>$prefix</tt>, if you want per user edit files in user directory. The files in user directory take precedence over system files. Changes to system files will not override user settings.</p>
<div class="sect2">
<div class="titlepage">
<h3 class="title"><a id="addentries" name="addentries"></a>To Add Menu Entries</h3>
</div>
<p>Create a desktop file using an existing file as a template. edit this file and add/edit a "Categories=" line at the bottom. This should include a keyword matching the appropriate menu item eg: for an Internet app you should have</p>
<pre class="programlisting">
Categories=Application;Network
        
</pre>
<br />
<br />
<p>Restart the panel.</p>
</div>
<div class="sect2">
<div class="titlepage">
<h3 class="title"><a id="removeentries" name="removeentries"></a>To Remove Menu Entries</h3>
</div>
<p>Edit appropriate <tt>applications.vfolder-info</tt> to include an &lt;Exclude&gt; &lt;/Exclude&gt; entry for the appropriate .desktop file.</p>
<p>Restart the panel.</p>
</div>
<div class="sect2">
<div class="titlepage">
<h3 class="title"><a id="remaddsubmenuapps" name="remaddsubmenuapps"></a>To remove/add submenus in the 'Applications' menu</h3>
</div>
<p>Edit appropriate <tt>applications.vfolder-info</tt>.</p>
<p>Create appropriate <tt>.directory</tt> file (remember name is set by the name field in the <tt>.directory</tt> file).</p>
</div>
<div class="sect2">
<div class="titlepage">
<h3 class="title"><a id="createnewsubresearchapp" name="createnewsubresearchapp"></a>To create a new submenu 'Research' in the 'Applications' menu</h3>
</div>
<p>Add $prefix/share/gnome/vfolders/Research.directory</p>
<p>Edit appropriate <tt>applications.vfolder-info</tt> file.</p>
</div>
</div>
<div class="sect1">
<div class="titlepage">
<h2 class="title"><a id="additionalinfo" name="additionalinfo"></a>Additional Information</h2>
</div>
<p>Additional details on manual editing of menus can be found <a href="http://www.redtux.demon.co.uk/docs/gnome_menu_edit_doc.20_6.html" target="_top">here</a>.</p>
</div>
</div>
</div>

<div id="sidebar">
<p class="section">Users</p>
<ul>
<li><b><a href="/about/">What is GNOME?</a></b></li>
<li><a href="/start/stable/">Download</a></li>
<!--<li><a href="/start/">Get Involved!</a></li>-->
<li><a href="http://www.gnomedesktop.org/">Community News</a></li>
<li><a href="/softwaremap/">Software Map</a></li>
<li><a href="http://foundation.gnome.org/">Foundation</a></li>
<li><a href="/press/">Press</a></li>
<li><a href="/contact/">Contact</a></li>
</ul>

<p class="section">Developers</p>
<ul>
<li><a href="http://library.gnome.org/devel/">Developer Site</a></li>
<li><a href="http://mail.gnome.org/">Mailing Lists</a></li>
<li><a href="http://bugzilla.gnome.org/">Bugzilla</a></li>
<li><a href="http://cvs.gnome.org/lxr/">LXR</a></li>
<li><a href="http://cvs.gnome.org/bonsai/">Bonsai</a></li>
</ul>
</div>

<div id="hdr">
<div id="logo"><a href="/"><img alt="Home" src="/img/spacer" /></a></div>
<div id="banner"><img alt="" src="/img/spacer" /></div>
<p class="none"></p>
<div id="hdrNav">
<a href="/about/">About GNOME</a> &middot;
<a href="/start/stable/">Download</a> &middot;
<!--<a href="/start/"><i>Get Involved!</i></a> &middot;-->
<a href="/"><b>Users</b></a> &middot;
<a href="http://art.gnome.org/">Art &amp; Themes</a> &middot;
<a href="http://library.gnome.org/devel/">Developers</a> &middot;
<a href="http://foundation.gnome.org/">Foundation</a> &middot;
<a href="/contact/">Contact</a>
</div>
</div>

<div id="copyright">
Copyright &copy; 2003, <a href="/">The GNOME Project</a>.<br />
<a href="http://validator.w3.org/check/referer">Optimised</a> for
<a href="http://www.w3.org/">standards</a>.
Hosted by <a href="http://www.redhat.com/">Red Hat</a>.
</div>

</body>
</html>
