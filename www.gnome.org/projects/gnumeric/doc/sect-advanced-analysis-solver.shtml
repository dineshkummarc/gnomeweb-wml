<?xml version="1.0"?>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Solver</title><link rel="previous" href="sect-advanced-analysis-goalseek.shtml" title="Goal Seek Tool"/><link rel="next" href="sect-advanced-analysis-simulation.shtml" title="Simulation Analysis"/><link rel="top" href="index.shtml" title="The Gnumeric Manual, version 1.4"/><link rel="stylesheet" type="text/css" href="gnumeric-doc.css"/></head><body><div class="body"><div class="sect1"><a name="sect-advanced-analysis-solver"/><h1 class="sect1 title"><span class="title">Solver</span></h1><p xmlns:msg="http://www.gnome.org/~shaunm/gnome-doc-utils/l10n" class="para">With Gnumeric Solver you can solve linear programs.</p><div class="sect2"><h2 class="sect2 title"><span class="title"><span class="label">6.4.1. </span>Introduction to Linear Programming</span></h2><p xmlns:msg="http://www.gnome.org/~shaunm/gnome-doc-utils/l10n" class="para">A linear program (LP) is a problem that can be expressed as
    linear functions.  As you probably already know, a linear function
    is the one whose graph is always a straight line.  Thus each
    variable of it appears in a separate term with its coefficient.
    There must be no products or quotients of these variables.  In
    addition, the exponent of each term must be one.  No logarithmic,
    exponential, trigonometric terms are allowed.  Especially note that
    functions like ABS, IF, MAX, and MIN are not linear.  Here are a
    few examples of linear functions:</p><div xmlns:msg="http://www.gnome.org/~shaunm/gnome-doc-utils/l10n" class="programlisting block-indent"><pre class="programlisting">    3x + y - 5z
    -3.23x + 0.33y
    -0.3x + 4y - 2z + 1.2m
    </pre></div><p xmlns:msg="http://www.gnome.org/~shaunm/gnome-doc-utils/l10n" class="para">The linear problem has a so called objective function which
    is to be minimized or maximized and constraints.  The objective
    function is the one whose value we would like to optimize.
    Typically, this function could determine the profit generated by
    the expected sales of the given model (maximization problem), or,
    the cost of the production in the given environment (minimization
    problem).  Anyway, on purely mathematical point of view, we could
    examine the following objective function:</p><div xmlns:msg="http://www.gnome.org/~shaunm/gnome-doc-utils/l10n" class="programlisting block-indent"><pre class="programlisting">    Maximize 2x + 3y - z
    </pre></div><p xmlns:msg="http://www.gnome.org/~shaunm/gnome-doc-utils/l10n" class="para">In linear programming the variables of this functions are
    not allowed to take any values (otherwise the maximum of any
    objective function would be infinity).  The problem also has
    constraints.  The constraints are a set of linear functions and a
    set of their right hand side values (RHS).  For example, for the
    previously defined objective function we have the following
    constraints:</p><div xmlns:msg="http://www.gnome.org/~shaunm/gnome-doc-utils/l10n" class="programlisting block-indent"><pre class="programlisting">    x + y &lt;= 5           (#1)
    3x - y + z &lt;= 9      (#2)
    x + y &gt;= 1           (#3)
    x + y + z = 4        (#4)
    x, y, z &gt;= 0         (non-negativity assumption)
    </pre></div><p xmlns:msg="http://www.gnome.org/~shaunm/gnome-doc-utils/l10n" class="para">This constraint set consists of three inequality constraints
    (#1-#3) and one equality constraint (#4).  Their RHS values are 5,
    9, 1, and 4.  In addition, we also have the non-negativity
    assumption.  That is, all the variables (x, y, and z) have to take
    only positive numbers.  The idea is to find the optimal values for
    the variables (x, y, and z) but also to satisfy all the given
    constraints.</p></div><div class="sect2"><h2 class="sect2 title"><span class="title"><span class="label">6.4.2. </span>Spreadsheet Modeling</span></h2><p xmlns:msg="http://www.gnome.org/~shaunm/gnome-doc-utils/l10n" class="para">To solve optimization problems with Gnumeric you have to
    type in the problem into a sheet.  A recommended way to start with
    is to allocate a separate column in the spreadsheet for each
    decision variable (in the previous example the x, y, and z) and a
    separate row for each constraint (the constraints #1-#4).  The
    coefficients of these variables should be placed into the cells
    corresponding to the allocated row and the column.  It is also
    recommended that you label the rows and the columns to make the
    sheet much more readable.  The sheet for our maximization problem
    would look like this:</p><div xmlns:msg="http://www.gnome.org/~shaunm/gnome-doc-utils/l10n" class="figure block-indent"><a name="fig-linear-program-example"/>
      <div class="title"><span class="title"><span class="label"><span style="font-style: italic; ">Figure 6-1</span> </span>Linear programming example</span></div>
      <div class="screenshot">
        <div class="mediaobject"><img src="figures/solver-01.png"/></div>
      </div>
    </div><p xmlns:msg="http://www.gnome.org/~shaunm/gnome-doc-utils/l10n" class="para">As you can see, we have put the model variables into cells
    B3:D3.  They are currently all zeros.  The cell E4 contains the
    objective function definition.  The easiest way to define it is to
    use SUMPRODUCT build-in function.  Thus in our model, we have the
    formula `=SUMPRODUCT(B3:D3,B4:D4)' in E3.</p><p xmlns:msg="http://www.gnome.org/~shaunm/gnome-doc-utils/l10n" class="para">The constraints are defined in rows seven to ten.  Since
    the coefficients of these functions are in columns B, C and D we
    will get the total sum of each of the constraint using the
    formula `SUMPRODUCT(B$3:D$3,Bn:Dn)' where n is the row number of
    the constraint.  For example, in E7 we have
    `=SUMPRODUCT(B$3:D$3,B7:D7)', in E8 `=SUMPRODUCT(B$3:D$3,B8:D8)'
    and so on.  The right hand side (RHS) values of the constraints
    are typed into cells G7:G10.</p></div><div class="sect2"><h2 class="sect2 title"><span class="title"><span class="label">6.4.3. </span>Using Solver</span></h2><div class="sect3"><h3 class="sect3 title"><span class="title"><span class="label">6.4.3.1. </span>Solver Parameters</span></h3><p xmlns:msg="http://www.gnome.org/~shaunm/gnome-doc-utils/l10n" class="para">Now it is time to select `Solver...' from the `Tools' menu.
      After you have done it, the following dialog will appear:</p><div xmlns:msg="http://www.gnome.org/~shaunm/gnome-doc-utils/l10n" class="figure block-indent"><a name="fig-solver-dialog-1"/>
        <div class="title"><span class="title"><span class="label"><span style="font-style: italic; ">Figure 6-2</span> </span>The empty Solver dialog.</span></div>
        <div class="screenshot">
          <div class="mediaobject"><img src="figures/solver-02.png"/></div>
        </div>
      </div><p xmlns:msg="http://www.gnome.org/~shaunm/gnome-doc-utils/l10n" class="para">Since we have the objective function in E3 type this into
      the `Set Target Cell:' entry.  We are about to maximize this
      function, thus the radio button `Max' should be pressed on.  By
      default, the problem is assumed to be maximization problem.  The
      input variables (x, y, and z) were in cells B3:D3 so type the
      cell range into the `By Changing Cells:' entry.</p><p xmlns:msg="http://www.gnome.org/~shaunm/gnome-doc-utils/l10n" class="para">The model to be optimized is a linear model.  Thus, we
      should check that the check button `Linear (LP/MILP)' is pressed
      on under the `Model Assumptions'.  Also make sure that the
      assume non-negative button is on, otherwise, the input variables
      can also take negative values.  There is also a check button
      `Assume Integer (Discrete)' which adds an integer constraint for
      all the input variables.  The integer optimization is
      described, however, later.</p><p xmlns:msg="http://www.gnome.org/~shaunm/gnome-doc-utils/l10n" class="para">A few additional options can be set too.  If you want to
      limit the number of iterations the optimization algorithm is
      allowed to take you can set the maximum number in the `Max
      iterations' entry box.  Similarly, you can limit the maximum
      time the optimization is allowed to take in the `Max time' entry
      box.  If either one of these settings is exceeded during the
      optimization, the optimization is interrupted and an error
      dialog is displayed.</p><p xmlns:msg="http://www.gnome.org/~shaunm/gnome-doc-utils/l10n" class="para">Some models can be better solved if the model is scaled
      into another form before the actual optimization.  Gnumeric
      solver supports automatic scaling which can be checked on by
      using the check button on the bottom of the dialog.  Note that
      the automatic scaling does not change the model since before
      checking out the results the model is scaled back to its
      original form.</p></div><div class="sect3"><h3 class="sect3 title"><span class="title"><span class="label">6.4.3.2. </span>Solver Constraints</span></h3><p xmlns:msg="http://www.gnome.org/~shaunm/gnome-doc-utils/l10n" class="para">Now we can add the constraints.  Select the `Constraints'
      page from the top of the dialog and the following page should
      appear.</p><div xmlns:msg="http://www.gnome.org/~shaunm/gnome-doc-utils/l10n" class="figure block-indent"><a name="fig-solver-add-constraint-dialog"/>
        <div class="title"><span class="title"><span class="label"><span style="font-style: italic; ">Figure 6-3</span> </span>Add constraint dialog.</span></div>
        <div class="screenshot">
          <div class="mediaobject"><img src="figures/solver-03.png"/></div>
        </div>
      </div><p xmlns:msg="http://www.gnome.org/~shaunm/gnome-doc-utils/l10n" class="para">In this page, you can see all constraints that have been
      defined in the `Subject to the Constraints:' window.  Since none
      has been defined, this window should be empty.  Now type in the
      constraints (#1-#4) one by one.</p><p xmlns:msg="http://www.gnome.org/~shaunm/gnome-doc-utils/l10n" class="para">When adding constraints, the three entry boxes in the
      bottom of the dialog are used.  Put a cell name of the total
      left hand side (LHS) cell into the `Left Hand Side:' entry box.
      In our example, this would be E7 for the constraint #1, E8 for
      constraint #2, and so on.  The combo entry in the middle defines
      the type of the constraint.  It can be `&lt;=', `=', `&gt;='
       , or `Int'.  We will explain the `Int' constraints later.
      In this example, you should select  `&lt;=' for
      constraints #1-#2, `&gt;=' for #3, and `=' for constraint #4.
      The last entry on the right takes the right hand side values of
      the constraints.  For constraints #1-#4 they should be G7 (5),
      G8 (9), G9 (1), and G10 (4) in this order.</p><p xmlns:msg="http://www.gnome.org/~shaunm/gnome-doc-utils/l10n" class="para">After typing a constraint press
      <span class="mousebutton">Add</span> button, and you will be able to
      define the next one.  When you have typed in all the
      constraints, the Solver dialog should look like this:</p><div xmlns:msg="http://www.gnome.org/~shaunm/gnome-doc-utils/l10n" class="figure block-indent"><a name="fig-solver-dialog-2"/>
        <div class="title"><span class="title"><span class="label"><span style="font-style: italic; ">Figure 6-4</span> </span>The solver dialog</span></div>
        <div class="screenshot">
          <div class="mediaobject"><img src="figures/solver-04.png"/></div>
        </div>
      </div><p xmlns:msg="http://www.gnome.org/~shaunm/gnome-doc-utils/l10n" class="para">The order of the constraints does not matter.  If you want
      to change or delete a constraint click it and then press
      `Change' or `Delete' button.</p><p xmlns:msg="http://www.gnome.org/~shaunm/gnome-doc-utils/l10n" class="para">Note that you can also type ranges into the LHS and RHS
      entries.  For example, you could have typed D7:D8 and G7:G8
      instead of the two separate constraints.</p><p xmlns:msg="http://www.gnome.org/~shaunm/gnome-doc-utils/l10n" class="para">If the constraints have now been typed in correctly, we
      should check what reports we want to produce.</p></div><div class="sect3"><h3 class="sect3 title"><span class="title"><span class="label">6.4.3.3. </span>Solver Reporting</span></h3><p xmlns:msg="http://www.gnome.org/~shaunm/gnome-doc-utils/l10n" class="para">Select the `Reports' page from the top of the dialog and
      the a page containing five check buttons should appear.  By
      pressing these check buttons on, you can produce various kinds of
      reports.  You can read more about solver reporting in the
      following section.</p></div><div class="sect3"><h3 class="sect3 title"><span class="title"><span class="label">6.4.3.4. </span>Optimization</span></h3><p xmlns:msg="http://www.gnome.org/~shaunm/gnome-doc-utils/l10n" class="para">After you have specified the parameters, the constraints
      and the reporting options it is time to press the `OK' button.
      If everything went ok, you will see a dialog saying: `Solver
      found an optimal solution. All constraints and optimality
      conditions are satisfied.'.  This means that the solver found an
      optimal solution and the optimal values are now stored into the
      input variables.  For all models, this, however, does not
      happen.</p><p xmlns:msg="http://www.gnome.org/~shaunm/gnome-doc-utils/l10n" class="para">If a feasible solution cannot be found, the solver reports
      that `A feasible solution could not be found. All specified
      constraints cannot be met simultaneously.'.</p><p xmlns:msg="http://www.gnome.org/~shaunm/gnome-doc-utils/l10n" class="para">If the model is unbounded, the solver reports that `The
      Target Cell value specified does not converge!  The program is
      unbounded.'.</p><p xmlns:msg="http://www.gnome.org/~shaunm/gnome-doc-utils/l10n" class="para">If the maximum number of iterations specified in the
      options was exceeded, the solver reports that `The maximum
      number of iterations exceeded. The optimal value could not be
      found.'.</p><p xmlns:msg="http://www.gnome.org/~shaunm/gnome-doc-utils/l10n" class="para">If the maximum time specified in the options was exceeded,
      the solver reports that `The maximum time exceeded. The optimal
      value could not be found in given time.'.</p></div></div><div class="sect2"><h2 class="sect2 title"><span class="title"><span class="label">6.4.4. </span>Solver Reports</span></h2><div class="sect3"><h3 class="sect3 title"><span class="title"><span class="label">6.4.4.1. </span>Answer Report</span></h3><p xmlns:msg="http://www.gnome.org/~shaunm/gnome-doc-utils/l10n" class="para">Answer report gives the original and final values for the
      problem and for all the input variables and the constraints.  In
      addition, for the constraints their formulas, binding status and
      the slacks are printed out nicely.  The answer report is given
      as a new sheet.</p></div><div class="sect3"><h3 class="sect3 title"><span class="title"><span class="label">6.4.4.2. </span>Sensitivity Report</span></h3><p xmlns:msg="http://www.gnome.org/~shaunm/gnome-doc-utils/l10n" class="para">Sensitivity report gives the shadow prices for the
      constraints.</p><p xmlns:msg="http://www.gnome.org/~shaunm/gnome-doc-utils/l10n" class="para">Note that if the model contains integer or boolean
      constraints, sensitivity report cannot be produced.</p></div><div class="sect3"><h3 class="sect3 title"><span class="title"><span class="label">6.4.4.3. </span>Limits Report</span></h3><p xmlns:msg="http://www.gnome.org/~shaunm/gnome-doc-utils/l10n" class="para">Limits report reports the achieved optimal value all the
      input variables of the model with the optimal values and with
      upper and lower bound for the optimal value in with the
      particular variable could vary without changing the optimal
      solution.</p><p xmlns:msg="http://www.gnome.org/~shaunm/gnome-doc-utils/l10n" class="para">If an optimal value for a variable x is 4, for example,
      and the lower bound is 2.4 and upper bound 5.9, then x could
      take any value between 2.4 and 5.9, and still all the same
      constraints were binding as with the optimal value 4.  In limits
      report, you can also find the value of the target cell for both
      upper and lower bound values for the variable.  For example, if
      the optimal value where x is 4 leads to a profit of $5,000,
      limits report specifies that if x is set to 2.4 the profit drops
      to $3,640.</p><p xmlns:msg="http://www.gnome.org/~shaunm/gnome-doc-utils/l10n" class="para">Note that if the model contains integer or boolean
      constraints, limits report cannot be produced.</p></div><div class="sect3"><h3 class="sect3 title"><span class="title"><span class="label">6.4.4.4. </span>Performance Report</span></h3><p xmlns:msg="http://www.gnome.org/~shaunm/gnome-doc-utils/l10n" class="para">Performance reports gives various statistical
      characteristics about the given model like how many variables
      and rows it contains, and how many non-zero matrix elements it
      has.  It also gives out the performance numbers like how much
      computing time was required to compute the results.</p></div><div class="sect3"><h3 class="sect3 title"><span class="title"><span class="label">6.4.4.5. </span>Program Report</span></h3><p xmlns:msg="http://www.gnome.org/~shaunm/gnome-doc-utils/l10n" class="para">Program report gives the model in its mathematical form.
      Program report is useful for checking out the correctness of the
      model.  It can also be useful for educational purposes.</p></div></div><div class="sect2"><h2 class="sect2 title"><span class="title"><span class="label">6.4.5. </span>Integer Programming</span></h2><p xmlns:msg="http://www.gnome.org/~shaunm/gnome-doc-utils/l10n" class="para">You can use the Solver tool also for integer programming
    (IP) and more generally mixed integer programming.  In integer
    programming some of the decision variables are required to take on
    integer values.  To do so, just add a constraint whose type is
    `Int'.</p></div></div></div><div class="navbar"><div class="navbar-prev"><span class="navbar-prev"><a class="navbar navbar-prev" href="sect-advanced-analysis-goalseek.shtml" title="Goal Seek Tool">Goal Seek Tool</a></span></div><div class="navbar-next"><span class="navbar-next"><a class="navbar navbar-next" href="sect-advanced-analysis-simulation.shtml" title="Simulation Analysis">Simulation Analysis</a></span></div></div></body></html>
