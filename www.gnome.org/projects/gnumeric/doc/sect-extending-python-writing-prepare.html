<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<style>
    div[class~="admonition"] {
      margin-left: 24px;
      margin-right: 24px;
      clear: left;
    }
    img[class~="admonition"] { float: left; }
  
    div[class~="autotoc"] { margin-left: 24px; padding: 0px; }
    div[class~="autotoc"] ul { margin-left: 0px; padding-left: 0px; }
    div[class~="autotoc"] ul li {
      margin-right: 0px;
      padding: 0px;
      list-style-type: none;
    }
    div[class~="autotoc"] ul li span[class~="label"] {
      margin-right: 0.8em;
    }
  
    div[class~="figure"] { margin-left: 24px; margin-right: 12px; }
    div[class~="figure"] div[class~="title"] span[class~="label"] {
      margin-right: 0.8em;
      font-style: italic;
    }
    pre[class~="programlisting"] {
      margin-left: 24px;
      margin-right: 12px;
      overflow: auto;
    }
    pre[class~="screen"] {
      margin-left: 24px;
      margin-right: 12px;
      overflow: auto;
    }
    pre[class~="synopsis"] {
      margin-left: 24px;
      margin-right: 12px;
      overflow: auto;
    }
    pre[class~="linenumbering"] {
      
      margin-top: 0px;
      margin-left: 18px;
      background-color: black;
      color: white;
      -moz-opacity: .3;
      padding-right: 0.4em;
      padding-left: 0.4em;
    }
    blockquote[class~="blockquote"] { margin-left: 24px; margin-right: 12px; }
    dt[class~="glossterm"] { margin-left: 8px; }
    dt[class~="glossterm"] + dd { margin-top: -8px; }
    dd[class~="glossdef"]     { margin-left: 24px; margin-right: 12px; }
    dd[class~="glosssee"]     { margin-left: 24px; margin-right: 12px; }
    dd[class~="glossseealso"] { margin-left: 24px; margin-right: 12px; }
  
    span[class~="co"] {
      font-size: 8px;
      padding-left:  0.4em;
      padding-right: 0.4em;
      margin-left:   0.2em;
      margin-right:  0.2em;
      border: solid 1px;
      -moz-border-radius: 8px;
      color: #FFFFFF;
      background-color: #000000;
      border-color: #000000;
    }
    span[class~="co"]:hover {
      color: #FFFFFF;
      background-color: #333333;
      border-color: #333333;
    }
    span[class~="co"] a { text-decoration: none; }
    span[class~="co"] a:hover { text-decoration: none; }
  
    div[class~="cmdsynopsis"] { font-family: monospace; }
  
    div[class~="list"] { margin-left: 24px; padding: 0px; }
    div[class~="list"] dl dt { margin-left: 0px; }
    div[class~="list"] dl dt + dd { margin-top: -8px; }
    div[class~="list"] dl dd {
      margin-left: 24px;
      margin-right: 12px;
    }
    div[class~="list"] ul { margin-left: 0px; padding-left: 0px; }
    div[class~="list"] ol { margin-left: 0px; padding-left: 0px; }
    div[class~="list"] ul li { margin-right: 12px; padding: 0px; }
    div[class~="list"] ol li { margin-right: 12px; padding: 0px; }
  
    dl[class~="qandaset"] dt + dd { margin-top: -8px; }
    dt[class~="question"] { margin-left: 0px; }
    dt[class~="question"] div[class~="label"] {
      float: right;
      margin-right: 1em;
    }
    dd[class~="answer"] { margin-left: 12px; }
    dt[class~="answer"] div[class~="label"] {
      float: right;
      margin-right: 1em;
    }
  
    div[class~="refentry"] h2[class~="refentry"] {
      border: none;
      margin-top: 1em;
    }
    div[class~="refentry"] + div[class~="refentry"] {
      border-top: dashed black 1px;
    }
  
    div[class~="table"] { margin-left: 24px; }
    div[class~="table"] div[class~="title"] { margin-bottom: 0.2em; }
    div[class~="table"] div[class~="title"] span[class~="label"] {
      margin-right: 0.8em;
      font-style: italic;
    }
    table {
      border-collapse: collapse;
      border: solid 1px;
      -moz-border-radius: 5px;
    }
  tr[class~="odd"] { background-color: #F0F0F0 }
    td { padding-left: 0.8em; padding-right: 0.8em; }
    th { padding-left: 0.8em; padding-right: 0.8em; }
    thead tr th {
      border-bottom: solid 1px;
    }
    td + td {
      border-left: solid 1px;
    }
    tbody {
      border: solid 1px;
      -moz-border-radius: 5px;
    }
  
    h1 { font-size: 1.6em; margin-top: 0em; }
    h2 { font-size: 1.4em; }
    h2[class~="title"] {
      margin-top: 1.8em;
      border-bottom: solid 1px;
    }
    h3 { font-size: 1.2em; margin-top: 1.8em; }
    h3 span[class~="title"] { border-bottom: solid 1px; }
    h4 { font-size: 1.0em; margin-top: 1.8em; }
    h4 span[class~="title"] { border-bottom: solid 1px; }
    h5 { font-size: 1.0em; margin-top: 1.2em; }
    h1 span[class~="label"] { padding-right: 0.8em; }
    h2 span[class~="label"] { padding-right: 0.8em; }
    h3 span[class~="label"] { padding-right: 0.8em; }
    h4 span[class~="label"] { padding-right: 0.8em; }
    h5 span[class~="label"] { padding-right: 0.8em; }
  
    body {
      padding-top: 8px;
      padding-left: 8px;
      padding-right: 12px;
    }
    div + div { margin-top: 1em; }
    p {
      text-align: justify;
    }
  </style>
</head>
<body><div class="sect3">
<a name="sect-extending-python-writing-prepare"></a><h1 class="sect3 title"><span class="title"><span class="label">13.3.4.1</span>Prepare the spellbook</span></h1>
<p class="para">In many ways it would be easier to start by copying the
	  py_func spellbook to your local .gnumeric folder, and just adding a
	  function to that. But in general it will be more useful to be
	  able to write your own separate spellbooks, so here we go.</p>
<div class="list"><div class="procedure"><ol>
<li>
		  <p class="para">
			<span class="emphasis" style="font-weight: bold; ">Make the folder: </span>
			First we make the folders and get into the right one. As noted
			above, we'll call our folder (spellbook) myfuncs.
		  </p>
		  <div class="substeps"><ol type="a">
			<li>
<p class="para">If they don't already exist:</p>
			  <div class="substeps"><ol type="i">
				<li><p class="para"><span class="literal" style="font-family: monospace; ">mkdir ~/.gnumeric</span></p></li>
				<li><p class="para"><span class="literal" style="font-family: monospace; ">mkdir ~/.gnumeric/&lt;version&gt;</span></p></li>
			  </ol></div>
			</li>
			<li><p class="para"><span class="literal" style="font-family: monospace; ">mkdir ~/.gnumeric/&lt;version&gt;/myfuncs/</span></p></li>
			<li><p class="para"><span class="literal" style="font-family: monospace; ">cd ~/.gnumeric/&lt;version&gt;/myfuncs/</span></p></li>
		  </ol></div>
		</li>
<li>
		  <p class="para">
			<span class="emphasis" style="font-weight: bold; ">Make the files:</span>
			A spellbook has two files. The first is the python file
			with the functions. The second is the XML file "plugin.xml". The
			XML file holds that master spells that tell Gnumeric what
			functions we've defined, and what the name of the python file
			<span class="emphasis" style="font-style: italic; ">is</span>, and one other important item. We'll create these as
			blank files.
		  </p>
		  <div class="substeps"><ol type="a">
			<li><p class="para"><span class="literal" style="font-family: monospace; ">touch my-func.py</span></p></li>
			<li><p class="para"><span class="literal" style="font-family: monospace; ">touch plugin.xml</span></p></li>
		  </ol></div>
		</li>
<li>
		  <p class="para">
			<span class="emphasis" style="font-weight: bold; ">Write the master spells</span>
			The good news is that you only need to do this once per
			spellbook. After that you just add spells to it.
		  </p>
		  <p class="para">Your XML file must tell Gnumeric about your plugin. Here is a
			simple template. (If you want to learn about internationalization,
			see the example in the system's py-func spellbook.) Open up
			plugin.xml and insert the following lines:
		  </p>

		  <div class="programlisting"><pre class="programlisting">
&lt;?xml version="1.0"?&gt;
&lt;plugin id="Gnumeric_MyFuncPlugin"&gt;
	&lt;information&gt;
		&lt;name&gt;Other Python functions from HOWTO&lt;/name&gt;
		&lt;description&gt;A few extra python functions demonstrating the API.&lt;/description&gt;
	&lt;/information&gt;
	&lt;loader type="Gnumeric_PythonLoader:python"&gt;
		&lt;attribute name="module_name" value="<span class="emphasis" style="font-weight: bold; ">my-func</span>"/&gt; <span class="co">3</span>
	&lt;/loader&gt;
	&lt;services&gt;
		&lt;service type="function_group" id="<span class="emphasis" style="font-weight: bold; ">example</span>"&gt; <span class="co">4</span>
			&lt;category&gt;Local Python&lt;/category&gt;
			&lt;functions&gt;
			&lt;/functions&gt;
		&lt;/service&gt;
	&lt;/services&gt;
&lt;/plugin&gt;
		  </pre></div>

                  
		  
			<p class="para">
			  The value of "name" determines the name of your python
			  script (file). In this case, it must be "my-func.py"
			</p>
		  

		  
			<p class="para">
			  The value of "id" here determines the name of the
			  function dictionary in your python script. In this case,
			  it must be "example_functions" because here the value is
			  "example".
			</p>
		  
                  
		</li>
<li>
		  <p class="para">
			<span class="emphasis" style="font-weight: bold; ">Prepare to write the
			spells:</span> Next we'll create a minimal python
			file. As noted above, we must name the file
			<span class="emphasis" style="font-weight: bold; ">my-func</span>.py and it must have a dictionary
			called <span class="emphasis" style="font-weight: bold; ">example</span>_functions.
			So open up my-func.py and insert the following lines.
		  </p>
		  <div class="programlisting"><pre class="programlisting">
# my-func.py
#

from Gnumeric import GnumericError GnumericErrorVALUE
import Gnumeric
import string
	
example_functions = {
}
		  </pre></div>
		</li>
</ol></div></div>
</div></body>
</html>
