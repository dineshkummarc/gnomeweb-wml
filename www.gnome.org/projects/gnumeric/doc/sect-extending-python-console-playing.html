<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<style>
    div[class~="admonition"] {
      margin-left: 24px;
      margin-right: 24px;
      clear: left;
    }
    img[class~="admonition"] { float: left; }
  
    div[class~="autotoc"] { margin-left: 24px; padding: 0px; }
    div[class~="autotoc"] ul { margin-left: 0px; padding-left: 0px; }
    div[class~="autotoc"] ul li {
      margin-right: 0px;
      padding: 0px;
      list-style-type: none;
    }
    div[class~="autotoc"] ul li span[class~="label"] {
      margin-right: 0.8em;
    }
  
    div[class~="figure"] { margin-left: 24px; margin-right: 12px; }
    div[class~="figure"] div[class~="title"] span[class~="label"] {
      margin-right: 0.8em;
      font-style: italic;
    }
    pre[class~="programlisting"] {
      margin-left: 24px;
      margin-right: 12px;
      overflow: auto;
    }
    pre[class~="screen"] {
      margin-left: 24px;
      margin-right: 12px;
      overflow: auto;
    }
    pre[class~="synopsis"] {
      margin-left: 24px;
      margin-right: 12px;
      overflow: auto;
    }
    pre[class~="linenumbering"] {
      
      margin-top: 0px;
      margin-left: 18px;
      background-color: black;
      color: white;
      -moz-opacity: .3;
      padding-right: 0.4em;
      padding-left: 0.4em;
    }
    blockquote[class~="blockquote"] { margin-left: 24px; margin-right: 12px; }
    dt[class~="glossterm"] { margin-left: 8px; }
    dt[class~="glossterm"] + dd { margin-top: -8px; }
    dd[class~="glossdef"]     { margin-left: 24px; margin-right: 12px; }
    dd[class~="glosssee"]     { margin-left: 24px; margin-right: 12px; }
    dd[class~="glossseealso"] { margin-left: 24px; margin-right: 12px; }
  
    span[class~="co"] {
      font-size: 8px;
      padding-left:  0.4em;
      padding-right: 0.4em;
      margin-left:   0.2em;
      margin-right:  0.2em;
      border: solid 1px;
      -moz-border-radius: 8px;
      color: #FFFFFF;
      background-color: #000000;
      border-color: #000000;
    }
    span[class~="co"]:hover {
      color: #FFFFFF;
      background-color: #333333;
      border-color: #333333;
    }
    span[class~="co"] a { text-decoration: none; }
    span[class~="co"] a:hover { text-decoration: none; }
  
    div[class~="cmdsynopsis"] { font-family: monospace; }
  
    div[class~="list"] { margin-left: 24px; padding: 0px; }
    div[class~="list"] dl dt { margin-left: 0px; }
    div[class~="list"] dl dt + dd { margin-top: -8px; }
    div[class~="list"] dl dd {
      margin-left: 24px;
      margin-right: 12px;
    }
    div[class~="list"] ul { margin-left: 0px; padding-left: 0px; }
    div[class~="list"] ol { margin-left: 0px; padding-left: 0px; }
    div[class~="list"] ul li { margin-right: 12px; padding: 0px; }
    div[class~="list"] ol li { margin-right: 12px; padding: 0px; }
  
    dl[class~="qandaset"] dt + dd { margin-top: -8px; }
    dt[class~="question"] { margin-left: 0px; }
    dt[class~="question"] div[class~="label"] {
      float: right;
      margin-right: 1em;
    }
    dd[class~="answer"] { margin-left: 12px; }
    dt[class~="answer"] div[class~="label"] {
      float: right;
      margin-right: 1em;
    }
  
    div[class~="refentry"] h2[class~="refentry"] {
      border: none;
      margin-top: 1em;
    }
    div[class~="refentry"] + div[class~="refentry"] {
      border-top: dashed black 1px;
    }
  
    div[class~="table"] { margin-left: 24px; }
    div[class~="table"] div[class~="title"] { margin-bottom: 0.2em; }
    div[class~="table"] div[class~="title"] span[class~="label"] {
      margin-right: 0.8em;
      font-style: italic;
    }
    table {
      border-collapse: collapse;
      border: solid 1px;
      -moz-border-radius: 5px;
    }
  tr[class~="odd"] { background-color: #F0F0F0 }
    td { padding-left: 0.8em; padding-right: 0.8em; }
    th { padding-left: 0.8em; padding-right: 0.8em; }
    thead tr th {
      border-bottom: solid 1px;
    }
    td + td {
      border-left: solid 1px;
    }
    tbody {
      border: solid 1px;
      -moz-border-radius: 5px;
    }
  
    h1 { font-size: 1.6em; margin-top: 0em; }
    h2 { font-size: 1.4em; }
    h2[class~="title"] {
      margin-top: 1.8em;
      border-bottom: solid 1px;
    }
    h3 { font-size: 1.2em; margin-top: 1.8em; }
    h3 span[class~="title"] { border-bottom: solid 1px; }
    h4 { font-size: 1.0em; margin-top: 1.8em; }
    h4 span[class~="title"] { border-bottom: solid 1px; }
    h5 { font-size: 1.0em; margin-top: 1.2em; }
    h1 span[class~="label"] { padding-right: 0.8em; }
    h2 span[class~="label"] { padding-right: 0.8em; }
    h3 span[class~="label"] { padding-right: 0.8em; }
    h4 span[class~="label"] { padding-right: 0.8em; }
    h5 span[class~="label"] { padding-right: 0.8em; }
  
    body {
      padding-top: 8px;
      padding-left: 8px;
      padding-right: 12px;
    }
    div + div { margin-top: 1em; }
    p {
      text-align: justify;
    }
  </style>
</head>
<body><div class="sect3">
<a name="sect-extending-python-console-playing"></a><h1 class="sect3 title"><span class="title"><span class="label">13.3.2.2</span>Playing with the Python console</span></h1>
<p class="para">
        At the top there is a drop-down menu <span class="guimenu" style="font-weight: bold; ">Execute
        in</span>. Right now your only choice will be
        <span class="guimenuitem" style="font-weight: bold; ">Default</span>. After you evaluate functions
        from other plugins, those environments will become available
        too (JK says this is called lazy loading). But I'll assume you
        are using Default. (The only real difference is that you have
        to import Gnumeric first, and you can't see your plugin
        functions.)
      </p>
<p class="para">
        (Note: older releases required you to type <span class="literal" style="font-family: monospace; ">print
        dir()</span> instead of just
        <span class="literal" style="font-family: monospace; ">dir()</span>. Fixed in cvs 16 June 2003, and
        certainly in 1.1.20 and higher.
      </p>
<p class="para">
        Let's start by taking a look at the environment.
      </p>
<div class="programlisting"><pre class="programlisting">
&gt;&gt;&gt; import <span class="co">1</span>Gnumeric
&gt;&gt;&gt; dir()
['Gnumeric', '__builtins__', '__doc__', '__name__']
&gt;&gt;&gt; dir(Gnumeric)
['Boolean', 'CellPos', 'FALSE', 'GnumericError', 'GnumericErrorDIV0',
'GnumericErrorNA', 'GnumericErrorNAME', 'GnumericErrorNULL',
'GnumericErrorNUM', 'GnumericErrorRECALC', 'GnumericErrorREF',
'GnumericErrorVALUE', 'MStyle', 'Range', 'TRUE', '__doc__',
'__name__', <span class="co">2</span>'functions', 'plugin_info', 'workbook_new', 'workbooks'] 

      </pre></div>
      
        <p class="para">
          'Gnumeric' is a module that exists only within Gnumeric, and
          which defines the Gnumeric Python API.
        </p>
      

      
        <p class="para">
          Gnumeric.functions is the list of all the Gnumeric functions
          you would see in the function browser. You cannot yet do
          <span class="literal" style="font-family: monospace; ">dir(Gnumeric.functions)</span> but maybe someone
          will bind that soon.
        </p>

        <p class="para">
          RangeRef is not listed. That seems to limit us, though later
          in the tutorial we'll see how to use regular functions to
          get inside RangeRefs.
        </p>

      
      <p class="para">
        So do some exploring. First, let's poke around to figure out
        how to use CellPos.
      </p>
<div class="programlisting"><pre class="programlisting">
# I wonder how to use CellPos (I've glanced at the source, but...)

&gt;&gt;&gt; dir(Gnumeric.CellPos)                 # shows nothing useful

&gt;&gt;&gt; Gnumeric.CellPos()                    
TypeError: CellPos() takes exactly 2 arguments (0 given)  

&gt;&gt;&gt; Gnumeric.CellPos("a1","a2") 
TypeError: an integer is required.        # Right. 

&gt;&gt;&gt; a=Gnumeric.CellPos(1,2)               # It worked!
&gt;&gt;&gt; a
&lt;CellPos object at 0x106b6eb8&gt;      # Yeah, I know...

&gt;&gt;&gt; dir(a)
['get_tuple']

&gt;&gt;&gt; a.get_tuple()
(1,2)                                     # Cool. That's (col,row)

&gt;&gt;&gt; str(a)                                # Super cool.
'B3'                                      # JK hasn't implemented this for tuples yet
       </pre></div>
<p class="para">
         Similarly, we can explore Gnumeric.Range:
       </p>
<div class="programlisting"><pre class="programlisting">
&gt;&gt;&gt; r = Gnumeric.Range((1,2),(3,4))
TypeError: Range() argument 1 must be CellPos, not tuple

&gt;&gt;&gt; r = Gnumeric.Range(a,a)
&gt;&gt;&gt; r
&lt;Range object at 0x1071d888&gt;

&gt;&gt;&gt; dir(r)
['get_tuple']

&gt;&gt;&gt; r.get_tuple()
(3, 7, 3, 7)
	  </pre></div>
<p class="para">If you
		evaluate in the context of a plugin (rather than in Default), then
		<span class="literal" style="font-family: monospace; ">dir(Gnumeric.plugin_info)</span> will reveal some simple
		informational functions you can call for the local plugin(s).</p>
<p class="para">Note: obviously I don't really know what I'm doing, or I wouldn't
		be poking around like this.</p>
</div></body>
</html>
