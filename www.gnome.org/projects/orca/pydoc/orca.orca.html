
<!doctype html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><title>Python: module orca.orca</title>
</head><body bgcolor="#f0f0f8">

<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="heading">
<tr bgcolor="#7799ee">
<td valign=bottom>&nbsp;<br>
<font color="#ffffff" face="helvetica, arial">&nbsp;<br><big><big><strong><a href="orca.html"><font color="#ffffff">orca</font></a>.orca</strong></big></big></font></td
><td align=right valign=bottom
><font color="#ffffff" face="helvetica, arial"><a href=".">index</a><br><a href="file:/usr/lib/python2.4/site-packages/orca/orca.py">/usr/lib/python2.4/site-packages/orca/orca.py</a></font></td></tr></table>
    <p><tt>#&nbsp;Orca<br>
#<br>
#&nbsp;Copyright&nbsp;2004-2006&nbsp;Sun&nbsp;Microsystems&nbsp;Inc.<br>
#<br>
#&nbsp;This&nbsp;library&nbsp;is&nbsp;free&nbsp;software;&nbsp;you&nbsp;can&nbsp;redistribute&nbsp;it&nbsp;and/or<br>
#&nbsp;modify&nbsp;it&nbsp;under&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;GNU&nbsp;Library&nbsp;General&nbsp;Public<br>
#&nbsp;License&nbsp;as&nbsp;published&nbsp;by&nbsp;the&nbsp;Free&nbsp;Software&nbsp;Foundation;&nbsp;either<br>
#&nbsp;version&nbsp;2&nbsp;of&nbsp;the&nbsp;License,&nbsp;or&nbsp;(at&nbsp;your&nbsp;option)&nbsp;any&nbsp;later&nbsp;version.<br>
#<br>
#&nbsp;This&nbsp;library&nbsp;is&nbsp;distributed&nbsp;in&nbsp;the&nbsp;hope&nbsp;that&nbsp;it&nbsp;will&nbsp;be&nbsp;useful,<br>
#&nbsp;but&nbsp;WITHOUT&nbsp;ANY&nbsp;WARRANTY;&nbsp;without&nbsp;even&nbsp;the&nbsp;implied&nbsp;warranty&nbsp;of<br>
#&nbsp;MERCHANTABILITY&nbsp;or&nbsp;FITNESS&nbsp;FOR&nbsp;A&nbsp;PARTICULAR&nbsp;PURPOSE.&nbsp;&nbsp;See&nbsp;the&nbsp;GNU<br>
#&nbsp;Library&nbsp;General&nbsp;Public&nbsp;License&nbsp;for&nbsp;more&nbsp;details.<br>
#<br>
#&nbsp;You&nbsp;should&nbsp;have&nbsp;received&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;GNU&nbsp;Library&nbsp;General&nbsp;Public<br>
#&nbsp;License&nbsp;along&nbsp;with&nbsp;this&nbsp;library;&nbsp;if&nbsp;not,&nbsp;write&nbsp;to&nbsp;the<br>
#&nbsp;Free&nbsp;Software&nbsp;Foundation,&nbsp;Inc.,&nbsp;59&nbsp;Temple&nbsp;Place&nbsp;-&nbsp;Suite&nbsp;330,<br>
#&nbsp;Boston,&nbsp;MA&nbsp;02111-1307,&nbsp;USA.</tt></p>
<p>
<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="section">
<tr bgcolor="#aa55cc">
<td colspan=3 valign=bottom>&nbsp;<br>
<font color="#fffff" face="helvetica, arial"><big><strong>Modules</strong></big></font></td></tr>
    
<tr><td bgcolor="#aa55cc"><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt></td><td>&nbsp;</td>
<td width="100%"><table width="100%" summary="list"><tr><td width="25%" valign=top><a href="orca.atspi.html">orca.atspi</a><br>
<a href="orca.braille.html">orca.braille</a><br>
<a href="orca.debug.html">orca.debug</a><br>
<a href="getopt.html">getopt</a><br>
<a href="gtk.html">gtk</a><br>
</td><td width="25%" valign=top><a href="orca.keybindings.html">orca.keybindings</a><br>
<a href="orca.keynames.html">orca.keynames</a><br>
<a href="orca.mag.html">orca.mag</a><br>
<a href="os.html">os</a><br>
<a href="orca.platform.html">orca.platform</a><br>
</td><td width="25%" valign=top><a href="orca.rolenames.html">orca.rolenames</a><br>
<a href="orca.settings.html">orca.settings</a><br>
<a href="signal.html">signal</a><br>
<a href="orca.speech.html">orca.speech</a><br>
<a href="string.html">string</a><br>
</td><td width="25%" valign=top><a href="sys.html">sys</a><br>
<a href="threading.html">threading</a><br>
<a href="time.html">time</a><br>
</td></tr></table></td></tr></table><p>
<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="section">
<tr bgcolor="#eeaa77">
<td colspan=3 valign=bottom>&nbsp;<br>
<font color="#ffffff" face="helvetica, arial"><big><strong>Functions</strong></big></font></td></tr>
    
<tr><td bgcolor="#eeaa77"><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt></td><td>&nbsp;</td>
<td width="100%"><dl><dt><a name="-abort"><strong>abort</strong></a>()</dt></dl>
 <dl><dt><a name="-abortOnSignal"><strong>abortOnSignal</strong></a>(signum, frame)</dt></dl>
 <dl><dt><a name="-cycleDebugLevel"><strong>cycleDebugLevel</strong></a>(script<font color="#909090">=None</font>, inputEvent<font color="#909090">=None</font>)</dt></dl>
 <dl><dt><a name="-drawOutline"><strong>drawOutline</strong></a>(x, y, width, height, erasePrevious<font color="#909090">=True</font>)</dt><dd><tt>Draws&nbsp;a&nbsp;rectangular&nbsp;outline&nbsp;around&nbsp;the&nbsp;accessible,&nbsp;erasing&nbsp;the<br>
last&nbsp;drawn&nbsp;rectangle&nbsp;in&nbsp;the&nbsp;process.</tt></dd></dl>
 <dl><dt><a name="-enterLearnMode"><strong>enterLearnMode</strong></a>(script<font color="#909090">=None</font>, inputEvent<font color="#909090">=None</font>)</dt><dd><tt>Turns&nbsp;learn&nbsp;mode&nbsp;on.&nbsp;&nbsp;The&nbsp;user&nbsp;must&nbsp;press&nbsp;the&nbsp;escape&nbsp;key&nbsp;to&nbsp;exit<br>
learn&nbsp;mode.<br>
&nbsp;<br>
Returns&nbsp;True&nbsp;to&nbsp;indicate&nbsp;the&nbsp;input&nbsp;event&nbsp;has&nbsp;been&nbsp;consumed.</tt></dd></dl>
 <dl><dt><a name="-exitLearnMode"><strong>exitLearnMode</strong></a>(script<font color="#909090">=None</font>, inputEvent<font color="#909090">=None</font>)</dt><dd><tt>Turns&nbsp;learn&nbsp;mode&nbsp;off.<br>
&nbsp;<br>
Returns&nbsp;True&nbsp;to&nbsp;indicate&nbsp;the&nbsp;input&nbsp;event&nbsp;has&nbsp;been&nbsp;consumed.</tt></dd></dl>
 <dl><dt><a name="-findActiveWindow"><strong>findActiveWindow</strong></a>()</dt><dd><tt>Traverses&nbsp;the&nbsp;list&nbsp;of&nbsp;known&nbsp;apps&nbsp;looking&nbsp;for&nbsp;one&nbsp;who&nbsp;has&nbsp;an<br>
immediate&nbsp;child&nbsp;(i.e.,&nbsp;a&nbsp;window)&nbsp;whose&nbsp;state&nbsp;includes&nbsp;the&nbsp;active&nbsp;state.<br>
&nbsp;<br>
Returns&nbsp;the&nbsp;Python&nbsp;Accessible&nbsp;of&nbsp;the&nbsp;window&nbsp;that's&nbsp;active&nbsp;or&nbsp;None&nbsp;if<br>
no&nbsp;windows&nbsp;are&nbsp;active.</tt></dd></dl>
 <dl><dt><a name="-init"><strong>init</strong></a>(registry)</dt><dd><tt>Initialize&nbsp;the&nbsp;orca&nbsp;module,&nbsp;which&nbsp;initializes&nbsp;speech,&nbsp;braille,<br>
and&nbsp;mag&nbsp;modules.&nbsp;&nbsp;Also&nbsp;builds&nbsp;up&nbsp;the&nbsp;application&nbsp;list,&nbsp;registers<br>
for&nbsp;AT-SPI&nbsp;events,&nbsp;and&nbsp;creates&nbsp;scripts&nbsp;for&nbsp;all&nbsp;known&nbsp;applications.<br>
&nbsp;<br>
Returns&nbsp;True&nbsp;if&nbsp;the&nbsp;initialization&nbsp;procedure&nbsp;has&nbsp;run,&nbsp;or&nbsp;False&nbsp;if&nbsp;this<br>
module&nbsp;has&nbsp;already&nbsp;been&nbsp;initialized.</tt></dd></dl>
 <dl><dt><a name="-isInActiveApp"><strong>isInActiveApp</strong></a>(obj)</dt><dd><tt>Returns&nbsp;True&nbsp;if&nbsp;the&nbsp;given&nbsp;object&nbsp;is&nbsp;from&nbsp;the&nbsp;same&nbsp;application&nbsp;that<br>
currently&nbsp;has&nbsp;keyboard&nbsp;focus.<br>
&nbsp;<br>
Arguments:<br>
-&nbsp;obj:&nbsp;an&nbsp;Accessible&nbsp;object</tt></dd></dl>
 <dl><dt><a name="-loadUserSettings"><strong>loadUserSettings</strong></a>(script<font color="#909090">=None</font>, inputEvent<font color="#909090">=None</font>)</dt><dd><tt>Loads&nbsp;(and&nbsp;reloads)&nbsp;the&nbsp;user&nbsp;settings&nbsp;module,&nbsp;reinitializing<br>
things&nbsp;such&nbsp;as&nbsp;speech&nbsp;if&nbsp;necessary.<br>
&nbsp;<br>
Returns&nbsp;True&nbsp;to&nbsp;indicate&nbsp;the&nbsp;input&nbsp;event&nbsp;has&nbsp;been&nbsp;consumed.</tt></dd></dl>
 <dl><dt><a name="-main"><strong>main</strong></a>()</dt></dl>
 <dl><dt><a name="-outlineAccessible"><strong>outlineAccessible</strong></a>(accessible, erasePrevious<font color="#909090">=True</font>)</dt><dd><tt>Draws&nbsp;a&nbsp;rectangular&nbsp;outline&nbsp;around&nbsp;the&nbsp;accessible,&nbsp;erasing&nbsp;the<br>
last&nbsp;drawn&nbsp;rectangle&nbsp;in&nbsp;the&nbsp;process.</tt></dd></dl>
 <dl><dt><a name="-printActiveApp"><strong>printActiveApp</strong></a>(script<font color="#909090">=None</font>, inputEvent<font color="#909090">=None</font>)</dt><dd><tt>Prints&nbsp;the&nbsp;active&nbsp;application.<br>
&nbsp;<br>
Arguments:<br>
-&nbsp;inputEvent:&nbsp;the&nbsp;key&nbsp;event&nbsp;(if&nbsp;any)&nbsp;which&nbsp;caused&nbsp;this&nbsp;to&nbsp;be&nbsp;called.<br>
&nbsp;<br>
Returns&nbsp;True&nbsp;indicating&nbsp;the&nbsp;event&nbsp;should&nbsp;be&nbsp;consumed.</tt></dd></dl>
 <dl><dt><a name="-printAncestry"><strong>printAncestry</strong></a>(script<font color="#909090">=None</font>, inputEvent<font color="#909090">=None</font>)</dt><dd><tt>Prints&nbsp;the&nbsp;ancestry&nbsp;for&nbsp;the&nbsp;current&nbsp;locusOfFocus</tt></dd></dl>
 <dl><dt><a name="-printApps"><strong>printApps</strong></a>(script<font color="#909090">=None</font>, inputEvent<font color="#909090">=None</font>)</dt><dd><tt>Prints&nbsp;a&nbsp;list&nbsp;of&nbsp;all&nbsp;applications&nbsp;to&nbsp;stdout<br>
&nbsp;<br>
Arguments:<br>
-&nbsp;inputEvent:&nbsp;the&nbsp;InputEvent&nbsp;instance&nbsp;that&nbsp;caused&nbsp;this&nbsp;to&nbsp;be&nbsp;called.<br>
&nbsp;<br>
Returns&nbsp;True&nbsp;indicating&nbsp;the&nbsp;event&nbsp;should&nbsp;be&nbsp;consumed.</tt></dd></dl>
 <dl><dt><a name="-printHierarchy"><strong>printHierarchy</strong></a>(script<font color="#909090">=None</font>, inputEvent<font color="#909090">=None</font>)</dt><dd><tt>Prints&nbsp;the&nbsp;application&nbsp;for&nbsp;the&nbsp;current&nbsp;locusOfFocus</tt></dd></dl>
 <dl><dt><a name="-setLocusOfFocus"><strong>setLocusOfFocus</strong></a>(event, obj, notifyPresentationManager<font color="#909090">=True</font>)</dt><dd><tt>Sets&nbsp;the&nbsp;locus&nbsp;of&nbsp;focus&nbsp;(i.e.,&nbsp;the&nbsp;object&nbsp;with&nbsp;visual&nbsp;focus)&nbsp;and<br>
notifies&nbsp;the&nbsp;current&nbsp;presentation&nbsp;manager&nbsp;of&nbsp;the&nbsp;change.<br>
&nbsp;<br>
Arguments:<br>
-&nbsp;event:&nbsp;if&nbsp;not&nbsp;None,&nbsp;the&nbsp;Event&nbsp;that&nbsp;caused&nbsp;this&nbsp;to&nbsp;happen<br>
-&nbsp;obj:&nbsp;the&nbsp;Accessible&nbsp;with&nbsp;the&nbsp;new&nbsp;locus&nbsp;of&nbsp;focus.<br>
-&nbsp;notifyPresentationManager:&nbsp;if&nbsp;True,&nbsp;propagate&nbsp;this&nbsp;event</tt></dd></dl>
 <dl><dt><a name="-shutdown"><strong>shutdown</strong></a>(script<font color="#909090">=None</font>, inputEvent<font color="#909090">=None</font>)</dt><dd><tt>Exits&nbsp;Orca.&nbsp;&nbsp;Unregisters&nbsp;any&nbsp;event&nbsp;listeners&nbsp;and&nbsp;cleans&nbsp;up.&nbsp;&nbsp;Also<br>
quits&nbsp;the&nbsp;bonobo&nbsp;main&nbsp;loop&nbsp;and&nbsp;resets&nbsp;the&nbsp;initialized&nbsp;state&nbsp;to&nbsp;False.<br>
&nbsp;<br>
Returns&nbsp;True&nbsp;if&nbsp;the&nbsp;shutdown&nbsp;procedure&nbsp;ran&nbsp;or&nbsp;False&nbsp;if&nbsp;this&nbsp;module<br>
was&nbsp;never&nbsp;initialized.</tt></dd></dl>
 <dl><dt><a name="-shutdownOnSignal"><strong>shutdownOnSignal</strong></a>(signum, frame)</dt></dl>
 <dl><dt><a name="-start"><strong>start</strong></a>(registry)</dt><dd><tt>Starts&nbsp;Orca.</tt></dd></dl>
 <dl><dt><a name="-timeout"><strong>timeout</strong></a>()</dt></dl>
 <dl><dt><a name="-toggleKeystrokeRecording"><strong>toggleKeystrokeRecording</strong></a>(script<font color="#909090">=None</font>, inputEvent<font color="#909090">=None</font>)</dt><dd><tt>Toggles&nbsp;the&nbsp;recording&nbsp;of&nbsp;keystrokes&nbsp;on&nbsp;and&nbsp;off.&nbsp;&nbsp;When&nbsp;the<br>
user&nbsp;presses&nbsp;the&nbsp;magic&nbsp;key&nbsp;(Pause),&nbsp;Orca&nbsp;will&nbsp;pop&nbsp;up&nbsp;a&nbsp;window<br>
requesting&nbsp;a&nbsp;filename.&nbsp;&nbsp;When&nbsp;the&nbsp;user&nbsp;presses&nbsp;the&nbsp;close&nbsp;button,<br>
Orca&nbsp;will&nbsp;start&nbsp;recording&nbsp;keystrokes&nbsp;to&nbsp;the&nbsp;file&nbsp;and&nbsp;will&nbsp;continue<br>
recording&nbsp;them&nbsp;until&nbsp;the&nbsp;user&nbsp;presses&nbsp;the&nbsp;magic&nbsp;key&nbsp;again.<br>
&nbsp;<br>
This&nbsp;functionality&nbsp;is&nbsp;used&nbsp;primarily&nbsp;to&nbsp;help&nbsp;gather&nbsp;keystroke<br>
information&nbsp;for&nbsp;regression&nbsp;testing&nbsp;purposes.&nbsp;&nbsp;The&nbsp;keystrokes&nbsp;are<br>
recorded&nbsp;in&nbsp;such&nbsp;a&nbsp;way&nbsp;that&nbsp;they&nbsp;can&nbsp;be&nbsp;played&nbsp;back&nbsp;via&nbsp;the<br>
src/tools/play_keystrokes.py&nbsp;utility.<br>
&nbsp;<br>
Arguments:<br>
-&nbsp;inputEvent:&nbsp;the&nbsp;key&nbsp;event&nbsp;(if&nbsp;any)&nbsp;which&nbsp;caused&nbsp;this&nbsp;to&nbsp;be&nbsp;called.<br>
&nbsp;<br>
Returns&nbsp;True&nbsp;indicating&nbsp;the&nbsp;event&nbsp;should&nbsp;be&nbsp;consumed.</tt></dd></dl>
 <dl><dt><a name="-usage"><strong>usage</strong></a>()</dt><dd><tt>Prints&nbsp;out&nbsp;usage&nbsp;information.</tt></dd></dl>
 <dl><dt><a name="-visualAppearanceChanged"><strong>visualAppearanceChanged</strong></a>(event, obj)</dt><dd><tt>Called&nbsp;(typically&nbsp;by&nbsp;scripts)&nbsp;when&nbsp;the&nbsp;visual&nbsp;appearance&nbsp;of&nbsp;an&nbsp;object<br>
changes&nbsp;and&nbsp;notifies&nbsp;the&nbsp;current&nbsp;presentation&nbsp;manager&nbsp;of&nbsp;the&nbsp;change.&nbsp;&nbsp;This<br>
method&nbsp;should&nbsp;not&nbsp;be&nbsp;called&nbsp;for&nbsp;objects&nbsp;whose&nbsp;visual&nbsp;appearance&nbsp;changes<br>
solely&nbsp;because&nbsp;of&nbsp;focus&nbsp;--&nbsp;setLocusOfFocus&nbsp;is&nbsp;used&nbsp;for&nbsp;that.&nbsp;&nbsp;Instead,&nbsp;it<br>
is&nbsp;intended&nbsp;mostly&nbsp;for&nbsp;objects&nbsp;whose&nbsp;notional&nbsp;'value'&nbsp;has&nbsp;changed,&nbsp;such&nbsp;as<br>
a&nbsp;checkbox&nbsp;changing&nbsp;state,&nbsp;a&nbsp;progress&nbsp;bar&nbsp;advancing,&nbsp;a&nbsp;slider&nbsp;moving,&nbsp;text<br>
inserted,&nbsp;caret&nbsp;moved,&nbsp;etc.<br>
&nbsp;<br>
Arguments:<br>
-&nbsp;event:&nbsp;if&nbsp;not&nbsp;None,&nbsp;the&nbsp;Event&nbsp;that&nbsp;caused&nbsp;this&nbsp;to&nbsp;happen<br>
-&nbsp;obj:&nbsp;the&nbsp;Accessible&nbsp;whose&nbsp;visual&nbsp;appearance&nbsp;changed.</tt></dd></dl>
</td></tr></table><p>
<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="section">
<tr bgcolor="#55aa55">
<td colspan=3 valign=bottom>&nbsp;<br>
<font color="#ffffff" face="helvetica, arial"><big><strong>Data</strong></big></font></td></tr>
    
<tr><td bgcolor="#55aa55"><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt></td><td>&nbsp;</td>
<td width="100%"><strong>MODIFIER_ORCA</strong> = 8<br>
<strong>exitCount</strong> = 0<br>
<strong>lastInputEvent</strong> = None<br>
<strong>lastKeyEchoTime</strong> = None<br>
<strong>locusOfFocus</strong> = None</td></tr></table>
</body></html>