<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Running the simulation</title>
<link rel="previous" href="sect-advanced-analysis-simulation-setup.shtml" title="Setting up the simulation model">
<link rel="next" href="sect-advanced-analysis-simulation-output.shtml" title="Simulation output">
<link rel="top" href="gnumeric.shtml" title="The Gnumeric Manual, version 1.8">
<link rel="stylesheet" type="text/css" href="gnumeric-doc.css">
</head>
<body>
<div class="navbar navbar-top"><table class="navbar"><tr>
<td class="navbar-prev"><a class="navbar-prev" href="sect-advanced-analysis-simulation-setup.shtml" title="Setting up the simulation model">Setting up the simulation model</a></td>
<td class="navbar-next"><a class="navbar-next" href="sect-advanced-analysis-simulation-output.shtml" title="Simulation output">Simulation output</a></td>
</tr></table></div>
<div class="sidebar"><div class="sidenav"><div class="autotoc"><ul>
<li><a href="gnumeric-info.shtml" title="About This Document">About This Document</a></li>
<li>
<a class="xref" href="gnumeric.shtml" title="The Gnumeric Manual, version 1.8">The Gnumeric Manual, version 1.8</a><div class="autotoc"><ul>
<li><a class="xref" href="chapter-welcome.shtml" title="Welcome!">Welcome!</a></li>
<li><a class="xref" href="chapter-manual-usage.shtml" title="How to Use this Manual">How to Use this Manual</a></li>
<li><a class="xref" href="chapter-quick-start.shtml" title="A Quick Introduction">A Quick Introduction</a></li>
<li><a class="xref" href="chapter-gui-elements.shtml" title="Gnumeric Elements">Gnumeric Elements</a></li>
<li><a class="xref" href="chapter-data.shtml" title="Working with Data">Working with Data</a></li>
<li>
<a class="xref" href="chapter-advanced-analysis.shtml" title="Advanced Analysis">Advanced Analysis</a><div class="autotoc"><ul>
<li><a class="xref" href="sect-analysis-overview.shtml" title="Advanced Analysis in Gnumeric">Advanced Analysis in Gnumeric</a></li>
<li><a class="xref" href="sect-advanced-analysis-complexNumbers.shtml" title="Analysis using Complex Numbers">Analysis using Complex Numbers</a></li>
<li><a class="xref" href="sect-advanced-analysis-goalseek.shtml" title="Goal Seek Tool">Goal Seek Tool</a></li>
<li><a class="xref" href="sect-advanced-analysis-solver.shtml" title="Solver">Solver</a></li>
<li>
<a class="xref" href="sect-advanced-analysis-simulation.shtml" title="Simulation Analysis">Simulation Analysis</a><div class="autotoc"><ul>
<li><a class="xref" href="sect-advanced-analysis-simulation-intro.shtml" title="Introduction to simulation analysis">Introduction to simulation analysis</a></li>
<li><a class="xref" href="sect-advanced-analysis-simulation-setup.shtml" title="Setting up the simulation model">Setting up the simulation model</a></li>
<li>Running the simulation</li>
<li><a class="xref" href="sect-advanced-analysis-simulation-output.shtml" title="Simulation output">Simulation output</a></li>
<li><a class="xref" href="sect-advanced-analysis-simulation-simtable.shtml" title="Using SIMTABLE">Using SIMTABLE</a></li>
<li><a class="xref" href="sect-advanced-analysis-simulation-iterations.shtml" title="Determining the number of iterations">Determining the number of iterations</a></li>
</ul></div>
</li>
<li><a class="xref" href="sect-advanced-analysis-scenarios.shtml" title="Analysis using scenarios">Analysis using scenarios</a></li>
<li><a class="xref" href="sect-analysis-statistical.shtml" title="Statistical Analysis">Statistical Analysis</a></li>
</ul></div>
</li>
<li><a class="xref" href="chapter-graphics.shtml" title="Graphics: Plots, Images, Widgets, and Drawings">Graphics: Plots, Images, Widgets, and Drawings</a></li>
<li><a class="xref" href="chapter-configuring.shtml" title="Configuring Gnumeric">Configuring Gnumeric</a></li>
<li><a class="xref" href="chapter-files.shtml" title="Working with Files">Working with Files</a></li>
<li><a class="xref" href="chapter-printing.shtml" title="Printing">Printing</a></li>
<li><a class="xref" href="chapter-morehelp.shtml" title="Getting More Help">Getting More Help</a></li>
<li><a class="xref" href="chapter-bugs.shtml" title="Reporting a Problem">Reporting a Problem</a></li>
<li><a class="xref" href="chapter-extending.shtml" title="Extending Gnumeric">Extending Gnumeric</a></li>
<li><a class="xref" href="function-reference.shtml" title="Function Reference">Function Reference</a></li>
<li><a class="xref" href="keybinding.shtml" title="Keybinding Reference">Keybinding Reference</a></li>
</ul></div>
</li>
</ul></div></div></div>
<div class="body body-sidebar"><div class="division sect2">
<a name="sect-advanced-analysis-simulation-running"></a><div class="header"><h1 class="sect2 title"><span class="title">Running the simulation</span></h1></div>
<ul class="linktrail">
<li class="linktrail linktrail-first"><a class="linktrail" href="gnumeric.shtml" title="The Gnumeric Manual, version 1.8">The Gnumeric Manual, version 1.8</a></li>
<li class="linktrail"><a class="linktrail" href="chapter-advanced-analysis.shtml" title="Advanced Analysis">Advanced Analysis</a></li>
<li class="linktrail linktrail-last"><a class="linktrail" href="sect-advanced-analysis-simulation.shtml" title="Simulation Analysis">Simulation Analysis</a></li>
</ul>
<p class="para block block-first">To run the simulation, from the Gnumeric toolbar, select Tools → Simulation.  In the Risk Simulation dialog box that appears, the first tab is the Variables tab.  There are two entries in the Variables tab:  Input variables and Output variables (<a class="xref" href="sect-advanced-analysis-simulation-running.shtml#analysis-simulation-variables-dialog" title="Variables tab in simulation dialog box">Figure 6-9</a>).</p>
<div class=" block figure block-indent">
<a name="analysis-simulation-variables-dialog"></a><div class="block block-first title title-formal"><span class="title"><span class="label"><span style="font-style: italic; ">Figure 6-9</span> </span>Variables tab in simulation dialog box</span></div>
<div class="figure-inner">
      
      <div class=" block screenshot block-first">
        <div class="mediaobject"><img src="figures/analysis-simulation-variables-dialog.png"></div>
      </div>
    </div>
</div>
<p class="para block">Input variables are the cells which hold the functions based on random numbers of the type described in Section A.14.  In this case, they are the cells B17 and B18 in the Profit worksheet, which hold the rand() function.  Later, when the quantity purchased is a parameter set by the <span class="function">SIMTABLE</span> function, cell B16 which holds the purchase quantity will be added to the range of input variables.</p>
<p class="para block">Output variables are the results of interest, or the dependent variable.  In this case, the dependent variables are the demand and the profit, which are in cells B20 and B21.</p>
<p class="para block">The next tab is the Options tab .  There are four settings in the options as shown in <a class="xref" href="sect-advanced-analysis-simulation-running.shtml#fig-analysis-simulation-options-dialog" title="Options tab in Simulation dialog box for newsvendor simulation example">Figure 6-10</a>. </p>
<div class=" block figure block-indent">
<a name="fig-analysis-simulation-options-dialog"></a><div class="block block-first title title-formal"><span class="title"><span class="label"><span style="font-style: italic; ">Figure 6-10</span> </span>Options tab in Simulation dialog box for newsvendor simulation example</span></div>
<div class="figure-inner">
      
      <div class=" block screenshot block-first">
        <div class="mediaobject"><img src="figures/analysis-simulation-options-dialog.png"></div>
      </div>
    </div>
</div>
<p class="para block">The second pair of options are the number of iterations and the Max time.  In a simulation, each iteration is the equivalent of a sample.  A sample from a random distribution is taken for each of the input values (as specified in the Variables tab) and the resulting output value(s).  The more iterations, the better the estimate of the output value.  However, this also takes more time to run.  A Max time value is specified in seconds where the simulation will end without output if an individual simulation takes longer then the Max time allotted.  If this occurs (see <a class="xref" href="sect-advanced-analysis-simulation-running.shtml#fig-analysis-simulation-maximumtime-dialog" title="Maximum time for simulation exceeded message box">Figure 6-11</a>), the options are to either increase the Max time value, or decrease the number of iterations.  A more drastic option is to change the model so that fewer calculations or samples of random numbers need to be made.</p>
<div class=" block figure block-indent">
<a name="fig-analysis-simulation-maximumtime-dialog"></a><div class="block block-first title title-formal"><span class="title"><span class="label"><span style="font-style: italic; ">Figure 6-11</span> </span>Maximum time for simulation exceeded message box</span></div>
<div class="figure-inner">
      
      <div class=" block screenshot block-first">
        <div class="mediaobject"><img src="figures/analysis-simulation-maximumtime-dialog.png"></div>
      </div>
    </div>
</div>
<p class="para block">The next tab is the Summary.  There are two boxes in this tab, the Simulation Summary and the Summary of results (see <a class="xref" href="sect-advanced-analysis-simulation-running.shtml#fig-analysis-simulation-summary-dialog" title="Summary tab for simulation tool">Figure 6-12</a>).  In simulation summary, there is a description of the simulation parameters.</p>
<div class="admonition block note block-indent"> 
      <p class="para block block-first">Due to the random nature of the simulation, the output may vary between simulation runs). </p>
    </div>
<div class=" block figure block-indent">
<a name="fig-analysis-simulation-summary-dialog"></a><div class="block block-first title title-formal"><span class="title"><span class="label"><span style="font-style: italic; ">Figure 6-12</span> </span>Summary tab for simulation tool</span></div>
<div class="figure-inner">
      
      <div class=" block screenshot block-first">
        <div class="mediaobject"><img src="figures/analysis-simulation-summary-dialog.png"></div>
      </div>
    </div>
</div>
<div class="block list itemizedlist"><ul class="itemizedlist">
<li class="li-first"><span class="para">Simulations:  Number of rounds as determined in the Simulation Options box.
      </span></li>
<li><span class="para">
      Iterations:  Number of iterations in a single simulation round.
      </span></li>
<li><span class="para">
      # input variables:  Number of random numbers sampled for each iteration. 
      </span></li>
<li><span class="para"># output variables:  Number of outputs recorded for simulation</span></li>
<li><span class="para">Runtime: Runtime of simulations in seconds.</span></li>
<li><span class="para">Run on: Date and time simulation was run.</span></li>
</ul></div>
<p class="para block">In the summary of results window, there are summary statistics for each round of the simulation.  If multiple rounds were done, the results of each round can be browsed by using the 'Prev. Sim.' and 'Next Sim.' buttons below the Summary of results box.  For each output and input variable, the summary shows the Min,  Average and the Max value across the iterations for that round of the simulation.  Note that for the input variables, this shows the random number that is the average, max and min.  If the statistics on intermediate values, such as a cost distribution, was desired, these intermediate values should be added to the list of output variables.</p>
<p class="para block">The last tab is labeled 'Output'.  This tab identifies the location where the output table will be generated.  There are two sets of options, first the Output Placement then Output Formatting as shown in <a class="xref" href="sect-advanced-analysis-simulation-running.shtml#fig-analysis-simulation-output-dialog" title="Output options tab for simulation">Figure 6-13</a>.</p>
<div class=" block figure block-indent">
<a name="fig-analysis-simulation-output-dialog"></a><div class="block block-first title title-formal"><span class="title"><span class="label"><span style="font-style: italic; ">Figure 6-13</span> </span>Output options tab for simulation</span></div>
<div class="figure-inner">
      
      <div class=" block screenshot block-first">
        <div class="mediaobject"><img src="figures/analysis-simulation-output-dialog.png"></div>
      </div>
    </div>
</div>
<p class="para block">The default output placement is 'New sheet'.  This will create a new sheet in the Gnumeric workbook labeled 'Simulation Report (1)', where '1' can be replaced with another number if a tab labeled 'Simulation Report (1)' already exists.  The option 'New workbook' creates a Gnumeric workbook named 'Book2.gnumeric' with a tab labeled 'Simulation Report.'</p>
<p class="para block">The third option is to embed the output table into an existing worksheet.  This is done by specifying the 'Output range'.  Note that the output range must be large enough to include the entire table, including heading information.  For a single round this requires 11 rows and 16 columns.  For example, the range Profit!A24:P35 would contain the statistics for one round with the three input variables and two output variables.  As input and output variables change, or the number of rounds of the simulation change, the number of rows required will change.</p>
<p class="para block">For output formatting, their are four options.</p>
<div class="block list itemizedlist"><ul class="itemizedlist">
<li class="li-first"><span class="para">'Autofit columns' automatically makes each column long enough to include the largest entry in that column.  Note that column 'A' in the resulting spreadsheet used to save run information such as date and time and is kept narrow.</span></li>
<li><span class="para">'Clear output range' is in effect if the Output Placement option chosen is Output range.  It clears the selected cells in the spreadsheet before putting the output table in its place.</span></li>
<li><span class="para">'Retain output range formatting' retains formatting for cells such as number formatting.</span></li>
<li><span class="para">'Retain output range comments' retains comments that have been placed in output cells.  This is most useful when the input and output variables remained the same.</span></li>
</ul></div>
</div></div>
<div class="navbar navbar-bottom"><table class="navbar"><tr>
<td class="navbar-prev"><a class="navbar-prev" href="sect-advanced-analysis-simulation-setup.shtml" title="Setting up the simulation model">Setting up the simulation model</a></td>
<td class="navbar-next"><a class="navbar-next" href="sect-advanced-analysis-simulation-output.shtml" title="Simulation output">Simulation output</a></td>
</tr></table></div>
</body>
</html>
