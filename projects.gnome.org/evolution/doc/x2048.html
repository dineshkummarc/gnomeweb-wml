<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <title>Create Rules to Automatically Organize Mail</title>
  <meta name="GENERATOR" content="Modular DocBook HTML Stylesheet Version 1.76b+" />
  <link rel="HOME" title="A User's Guide to Ximian Evolution 1.4" href="book1.html" />
  <link rel="UP" title="Organizing and Managing your Email" href="c1827.html" />
  <link rel="PREVIOUS" title="Searching for Messages" href="x2002.html" />
  <link rel="NEXT" title="Getting Really Organized with vFolders" href="x2279.html" />
</head>

<body class="sect1" bgcolor="#FFFFFF" text="#000000" link="#0000FF" vlink="#840084" alink="#0000FF">
  <div class="NAVHEADER">
    <table summary="Header navigation table" width="100%" border="0" cellpadding="0" cellspacing="0">
      <tr>
        <th colspan="3" align="center">A User's Guide to Ximian Evolution 1.4</th>
      </tr>

      <tr>
        <td width="10%" align="left" valign="bottom"><a href="x2002.html" accesskey="P">&lt;&lt;&lt; Previous</a></td>

        <td width="80%" align="center" valign="bottom">Organizing and Managing your Email</td>

        <td width="10%" align="right" valign="bottom"><a href="x2279.html" accesskey="N">Next &gt;&gt;&gt;</a></td>
      </tr>
    </table>
    <hr align="left" width="100%" />
  </div>

  <div class="sect1">
    <h1 class="sect1"><a name="usage-mail-organize-filters" id="usage-mail-organize-filters"></a>Create Rules to Automatically Organize Mail</h1>

    <p>Filters work very much like the mail room in a large company. Their purpose is to bundle, sort, and distribute mail to the various folders. In addition, you can have multiple filters performing multiple actions that may effect the same message in several ways. For example, your filters could put copies of one message into multiple folders, or keep a copy and send one to another person as well, and it can do that quickly. Of course, it's also faster and more flexible than an actual person with a pile of envelopes.</p>

    <div class="tip">
      <a name="easy-filter" id="easy-filter"></a>

      <table class="tip" width="100%" border="0">
        <tr>
          <td width="25" align="center" valign="top"><img src="./stylesheet-images/tip.gif" hspace="5" alt="Tip" /></td>

          <th align="left" valign="middle"><b>Quick Filter Creation</b></th>
        </tr>

        <tr>
          <td>&nbsp;</td>

          <td align="left" valign="top">
            <p>There is an easy shortcut for fast filter or vFolder creation. Right-click on the message in the message list, and select one of the items under the <b class="guimenuitem">Create Rule from Message</b> submenu.</p>
          </td>
        </tr>
      </table>
    </div>

    <div class="sect2">
      <h2 class="sect2"><a name="usage-mail-org-filters-new" id="usage-mail-org-filters-new"></a>Making New Filters</h2>

      <p>To create a new filter:</p>

      <ol type="1">
        <li>
          <p>Click <b class="guimenu">Tools</b>-&gt;<b class="guimenuitem">Filters</b></p>
        </li>

        <li>
          <p>Press the <b class="guibutton">Add</b> button.</p>
        </li>

        <li>
          <p>Name your filter in the <tt class="guilabel"><b>Rule name</b></tt> field. For each filter criterion, you must first select which of the following parts of the message you want the filter to examine:</p>

          <ul>
            <li>
              <p>Sender - The sender's address.</p>
            </li>

            <li>
              <p>Recipients - The recipients of the message.</p>
            </li>

            <li>
              <p>Subject - The subject line of the message.</p>
            </li>

            <li>
              <p>Specific Header - The filter can look at any header you want, even obscure or custom ones. Enter the header name in the first text box, and put your search text in the second one.</p>

              <div class="note">
                <a name="multiple-repeated-headers" id="multiple-repeated-headers"></a>

                <table class="note" width="100%" border="0">
                  <tr>
                    <td width="25" align="center" valign="top"><img src="./stylesheet-images/note.gif" hspace="5" alt="Note" /></td>

                    <th align="left" valign="middle"><b>Repeated Headers</b></th>
                  </tr>

                  <tr>
                    <td>&nbsp;</td>

                    <td align="left" valign="top">
                      <p>If a message uses a header more than once, Evolution will pay attention only to the first instance, even if the message defines the header differently the second time. For example, if a message declares the Resent-From: header as "engineering@rupertcorp.com" and then restates it as "marketing@rupertcorp.com," Evolution will filter as though the second declaration had not occurred. To filter on messages that use headers multiple times, use a regular expression.</p>
                    </td>
                  </tr>
                </table>
              </div><br />
              <br />
            </li>

            <li>
              <p>Message Body - Search in the actual text of the message.</p>
            </li>

            <li>
              <p>Expression - For programmers only: match a message according to an expression you write in the Scheme language, used to define filters in <tt class="application">Ximian Evolution</tt>.</p>

              <div class="figure">
                <a name="usage-mail-filter-fig-createrule" id="usage-mail-filter-fig-createrule"></a>

                <div class="mediaobject">
                  <p><img src="figures/filter-new-fig.png" alt="][" /></p>
                </div>

                <p><b>Figure 1. Creating a Mail Filter</b></p>
              </div>

              <div class="note">
                <a name="lots-of-filters" id="lots-of-filters"></a>

                <table class="note" width="100%" border="0">
                  <tr>
                    <td width="25" align="center" valign="top"><img src="./stylesheet-images/note.gif" hspace="5" alt="Note" /></td>

                    <th align="left" valign="middle"><b>What if Multiple Filters Match One Message?</b></th>
                  </tr>

                  <tr>
                    <td>&nbsp;</td>

                    <td align="left" valign="top">
                      <p>If you have several filters that match a single message, they will all be applied to the message, in order, unless one of the filters has the action <b class="guibutton">Stop Processing</b>. If you use that action in a filter, the messages that it affects will not be touched by other filters.</p>

                      <p>When you first open the filters dialog, you are shown the list of filters sorted in the order in which they will be applied. You can move them up and down in the priority list by clicking the <b class="guibutton">Up</b> and <b class="guibutton">Down</b> buttons.</p>
                    </td>
                  </tr>
                </table>
              </div><br />
              <br />
            </li>

            <li>
              <p>Date sent - Filter messages according to the date on which they were sent: First, choose the conditions you want a message to meet -- <tt class="guilabel"><b>before</b></tt> a given time, <tt class="guilabel"><b>after</b></tt> it, and so forth. Then, choose the time. The filter will compare the message's time-stamp to the system clock when the filter is run, or to a specific time and date you choose from a calendar. You can even have it look for messages within a range of time relative to the filter -- perhaps you're looking for messages less than two days old.</p>
            </li>

            <li>
              <p>Date Received - This works the same way as the <tt class="guilabel"><b>Date Sent</b></tt> option, except that it compares the time you got the message with the dates you specify.</p>
            </li>

            <li>
              <p>Score - Emails have a standard priority range from -3 (least important) to 3 (most important). You can have filters set the priority of messages you receive, and then have other filters applied only to those messages which have a certain priority.</p>
            </li>

            <li>
              <p>Size (kb) - Sorts based on the size of the message in kilobytes.</p>
            </li>

            <li>
              <p>Status - Filters according to the status of a message, such as 'New'.</p>
            </li>

            <li>
              <p>Attachments - Create a filter based on whether or not you have an attachment in the email.</p>
            </li>

            <li>
              <p>Mailing List - Filter based on the mailing list it came from.</p>

              <div class="note">
                <table class="note" width="100%" border="0">
                  <tr>
                    <td width="25" align="center" valign="top"><img src="./stylesheet-images/note.gif" hspace="5" alt="Note" /></td>

                    <th align="left" valign="middle"><b>How Does Filtering on Mailing Lists Work?</b></th>
                  </tr>

                  <tr>
                    <td>&nbsp;</td>

                    <td align="left" valign="top">
                      <p>Filtering on mailing list actually looks for a specific mailing-list header called the <tt class="computeroutput">X-BeenThere</tt> header, used to identify mailing lists or other redistributors of mail.</p>
                    </td>
                  </tr>
                </table>
              </div>
            </li>

            <li>
              <p>Expression - If you know your way around a <a href="g4137.html#regular-expression"><i class="glossterm">regex</i></a>, or regular expression, put your knowledge to use here. This allows you to search for complex patterns of letters, so that you can find, for example, all words that start with a and ends with m, and are between six and fifteen letters long, or all messages that declare a particular header twice. For information about how to use regular expressions, check the manual page for the <b class="command">grep</b> command.</p>
            </li>

            <li>
              <p>Source Account - Filter messages according the server you got them from. You can enter a URL or choose one from the drop-down list. This ability is only relevant if you use more than one mail source.</p>
            </li>
          </ul><br />
          <br />
        </li>

        <li>
          <p>Select the criterion for the condition. If you want multiple criteria for this filter, press <b class="guibutton">Add criterion</b> and repeat the previous step.</p>
        </li>

        <li>
          <p>Select the actions for the filter in the <tt class="guilabel"><b>Then</b></tt> section. You can select any of the following options.</p>

          <ul>
            <li>
              <p>Move to Folder - If you select this item, <tt class="application">Ximian Evolution</tt> will put the messages into a folder you specify. Click the <b class="guibutton">&lt;click here to select a folder&gt;</b> button to select a folder.</p>
            </li>

            <li>
              <p>Copy to Folder - If you select this item, <tt class="application">Ximian Evolution</tt> will put the messages into a folder you specify. Click the <b class="guibutton">&lt;click here to select a folder&gt;</b> button to select a folder.</p>
            </li>

            <li>
              <p>Forward to Address - Select this, enter an address, and the addressee will get a copy of the message.</p>
            </li>

            <li>
              <p>Delete - Marks the message for deletion. You can still get the message back, at least until you <b class="guimenuitem">Expunge</b> your mail yourself.</p>
            </li>

            <li>
              <p>Stop Processing - Select this if you want to tell all other filters to ignore this message, because whatever you've done with it so far is plenty.</p>
            </li>

            <li>
              <p>Assign Color - Select this item, and <tt class="application">Ximian Evolution</tt> will mark the message with whatever color you please.</p>
            </li>

            <li>
              <p>Assign Score - If you know that all mail with "important" somewhere in the message body line is important, you can give it a high priority score. In a subsequent filter you can then arrange your messages by their priority score.</p>
            </li>
          </ul><br />
          <br />
        </li>

        <li>
          <p>Set Status - If you want to add multiple actions for this filter, press <b class="guibutton">Add action</b> and repeat the previous step.</p>
        </li>

        <li>
          <p>Press <b class="guibutton">OK</b>.</p>
        </li>
      </ol><br />
      <br />

      <div class="note">
        <a name="when-filters-go-wrong" id="when-filters-go-wrong"></a>

        <table class="note" width="100%" border="0">
          <tr>
            <td width="25" align="center" valign="top"><img src="./stylesheet-images/note.gif" hspace="5" alt="Note" /></td>

            <th align="left" valign="middle"><b>When Are Filters Applied?</b></th>
          </tr>

          <tr>
            <td>&nbsp;</td>

            <td align="left" valign="top">
              <p>If you use Ximian Connector to store your mail on an Exchange server, filters are not applied until you open your INBOX folder and select <b class="guimenu">Actions</b>-&gt;<b class="guimenuitem">Apply Filters</b> or press <b class="keycap">Ctrl</b>-<b class="keycap">Y</b></p>
            </td>
          </tr>
        </table>
      </div>

      <div class="example">
        <a name="filter-example" id="filter-example"></a>

        <p><b>Example 1. Using a Filter to Avoid Spam</b></p>

        <p>Spam, also known as unsolicited commercial email (UCE), is the bane of many people's Inboxes, but it doesn't have to be. Using Ximian Evolution filters and an external Spam detection tool like SpamAssassin (<a href="http://spamassassin.org/" target="_top">http://spamassassin.org/</a>), you can catch the vast majority of junk mail and drop it directly into the trash.</p>

        <p>The easiest way to do this is to get your system administrator to install SpamAssassin (or its equivalent) on your mail server. There, it will flag messages it suspects of being Spam with the "X-Spam-Status" header to your mail, which you can then search for in a filter. Because SpamAssassin scores mails based on the likelihood that messages are junk, you can even choose how strict you want it to be. If you don't have a friendly network administrator, never fear: you can install SpamAssassin on your own system, then pipe messages through it before reading them.</p>

        <p>If your system administrator or ISP has SpamAssassin, here's how to siphon off the junk mail:</p>

        <ol type="1">
          <li>
            <p>Select <b class="guimenu">Tools</b>-&gt;<b class="guimenuitem">Filters</b>.</p>
          </li>

          <li>
            <p>Click <b class="guibutton">Add</b>.</p>
          </li>

          <li>
            <p>Set the first part of your search criterion to look in a <tt class="guilabel"><b>Specific header</b></tt>.</p>
          </li>

          <li>
            <p>Enter <tt class="userinput"><b>X-Spam-Flag</b></tt> as the name of the header.</p>
          </li>

          <li>
            <p>Choose <tt class="guilabel"><b>contains</b></tt> at the second drop-down box.</p>
          </li>

          <li>
            <p>Enter <tt class="userinput"><b>YES</b></tt> as the content to search for. You're now working with all email that has the word "YES" in the "X-Spam-Status" header.</p>
          </li>

          <li>
            <p>For actions, choose what you'd like to do with the messages. You can delete the messages automatically, but it's more prudent to place them in a "Possible Junk Mail" folder, and check them over just to make sure a genuine message didn't get flagged by accident.</p>
          </li>

          <li>
            <p>Click OK. You're done.</p>
          </li>
        </ol><br />
        <br />

        <p>If you don't have SpamAssassin or other junk mail filtering on your mail server, there's still hope, although it's not quite as simple. First, download and install SpamAssassin from <a href="http://spamassassin.org" target="_top">http://spamassassin.org</a> You'll need to download the "spamassassin" and "perl-Mail-SpamAssassin" packages, and you can install them with Red Carpet by selecting <b class="guimenuitem">Install Local Packages</b> from the <b class="guimenu">File</b> menu. Further instructions are at the SpamAssassin web site. Once you have the software installed, do the following:</p>

        <ol type="1">
          <li>
            <p>Open a new create a text file with any text editor ( <b class="guimenu">Programs</b> -&gt; <b class="guisubmenu">Accessories</b> -&gt; <b class="guimenuitem">Text Editor</b> is the most convenient) and paste in the following:</p>

            <table border="0" bgcolor="#E0E0E0" width="100%">
              <tr>
                <td>
                  <pre class="screen">

               spamassassin -e
             
</pre>
                </td>
              </tr>
            </table>This will run the SpamAssassin command and report back 0 if the message is not junk.<br />
            <br />
          </li>

          <li>
            <p>Save the file as "spam-filter.sh"</p>
          </li>

          <li>
            <p>Mark the file as an executable program: Open your home directory in Nautilus, right-click on spam-filter.sh there, and select <b class="guimenuitem">Properties</b>. Then, click the "Permissions" tab and check the box in the <tt class="guilabel"><b>Execute</b></tt> column and the <tt class="guilabel"><b>Owner</b></tt> row. Alternately, open a terminal ( <b class="guimenu">Programs</b> -&gt; <b class="guisubmenu">Accessories</b> -&gt; <b class="guimenuitem">Terminal</b> ) and enter the command: chmod +x spam-filter.sh.</p>
          </li>

          <li>
            <p>Back in Evolution, create a new filter: Select <b class="guimenu">Tools</b>-&gt;<b class="guimenuitem">Filters</b>, then click <b class="guibutton">Add</b>.</p>
          </li>

          <li>
            <p>Select "Pipe Message to Shell Command" as the first portion of the criterion.</p>
          </li>

          <li>
            <p>Enter "/home/username/spam-filter.sh" as the shell command, then select "Does Not Return" and "0" as the remaining two items. Substitute your username for "username" so that Evolution can find the script.</p>
          </li>

          <li>
            <p>For actions, choose what you'd like to do with the messages. You can delete the messages automatically, but it's more prudent to place them in a "Possible Junk Mail" folder, and check them over just to make sure a genuine message didn't get flagged by accident.</p>
          </li>

          <li>
            <p>You're done. Click "OK" to close the filter and "OK" to close the filter editor.</p>
          </li>
        </ol>
      </div>
    </div>

    <div class="sect2">
      <h2 class="sect2"><a name="filters-edit" id="filters-edit"></a>Editing Filters</h2>

      <p>To edit a filter:</p>

      <ol type="1">
        <li>
          <p>Select <b class="guimenu">Tools</b>-&gt;<b class="guimenuitem">Filters</b></p>
        </li>

        <li>
          <p>Select the filter in the <tt class="guilabel"><b>Filter Rules</b></tt> section and press <b class="guibutton">Edit</b>.</p>
        </li>

        <li>
          <p>Change the desired settings.</p>
        </li>

        <li>
          <p>Press <b class="guibutton">OK</b> in the filter editor window.</p>
        </li>

        <li>
          <p>Press <b class="guibutton">OK</b> in the filter manager window.</p>
        </li>
      </ol>
    </div><br />

    <div class="sect2">
      <h2 class="sect2"><a name="filters-deleting" id="filters-deleting"></a>Deleting Filters</h2>

      <p>To delete a filter:</p>

      <ol type="1">
        <li>
          <p>Select <b class="guimenu">Tools</b>+<b class="guimenu">Filters</b></p>
        </li>

        <li>
          <p>Select the filter and press <b class="guibutton">Delete</b>.</p>
        </li>
      </ol><br />
      <br />

      <div class="note">
        <table class="note" width="100%" border="0">
          <tr>
            <td width="25" align="center" valign="top"><img src="./stylesheet-images/note.gif" hspace="5" alt="Note" /></td>

            <th align="left" valign="middle"><b>Changing Folder Names and Filters</b></th>
          </tr>

          <tr>
            <td>&nbsp;</td>

            <td align="left" valign="top">
              <ul>
                <li>
                  <p>Incoming email that your filters don't move goes into the Inbox; outgoing mail that they don't move ends up in the Sent folder. So be sure to change the filters that go with it.</p>
                </li>
              </ul><br />
              <br />
            </td>
          </tr>
        </table>
      </div>
    </div>
  </div>

  <div class="NAVFOOTER">
    <hr align="left" width="100%" />

    <table summary="Footer navigation table" width="100%" border="0" cellpadding="0" cellspacing="0">
      <tr>
        <td width="33%" align="left" valign="top"><a href="x2002.html" accesskey="P">&lt;&lt;&lt; Previous</a></td>

        <td width="34%" align="center" valign="top"><a href="book1.html" accesskey="H">Home</a></td>

        <td width="33%" align="right" valign="top"><a href="x2279.html" accesskey="N">Next &gt;&gt;&gt;</a></td>
      </tr>

      <tr>
        <td width="33%" align="left" valign="top">Searching for Messages</td>

        <td width="34%" align="center" valign="top"><a href="c1827.html" accesskey="U">Up</a></td>

        <td width="33%" align="right" valign="top">Getting Really Organized with vFolders</td>
      </tr>
    </table>
  </div>
</body>
</html>
